{"version":3,"sources":["assets\\scripts\\Menu\\LoadingManager.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAE5E,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAA4C,kCAAY;IAAxD;QAAA,qEAiCC;QA/BG,iBAAW,GAAmB,IAAI,CAAC;QAGnC,kBAAY,GAAa,IAAI,CAAC;;IA4BlC,CAAC;IA1BG,qCAAY,GAAZ,UAAa,WAAmB;QAAhC,iBAuBC;QAtBD,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,CAAC,CAAC;QAC9B,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,IAAI,CAAC;QAEhC,EAAE,CAAC,QAAQ,CAAC,YAAY,CACpB,WAAW,EACX,UAAC,cAAc,EAAE,UAAU,EAAE,IAAI;YAC7B,IAAI,QAAQ,GAAG,cAAc,GAAG,UAAU,CAAC;YAC3C,mBAAmB;YACnB,IAAI,QAAQ,GAAG,GAAG;gBAAE,QAAQ,GAAG,GAAG,CAAC;YACnC,KAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACrC,KAAI,CAAC,YAAY,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;QAChE,CAAC,EACD;YACI,wBAAwB;YACxB,EAAE,CAAC,KAAK,CAAC,KAAI,CAAC,WAAW,CAAC;iBACrB,EAAE,CAAC,GAAG,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;iBACxB,IAAI,CAAC;gBACF,KAAI,CAAC,YAAY,CAAC,MAAM,GAAG,MAAM,CAAC;gBAClC,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;YACvC,CAAC,CAAC;iBACD,KAAK,EAAE,CAAC;QACjB,CAAC,CAAC,CAAC;IACP,CAAC;IA5BD;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;uDACU;IAGnC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;wDACW;IALb,cAAc;QADlC,OAAO;OACa,cAAc,CAiClC;IAAD,qBAAC;CAjCD,AAiCC,CAjC2C,EAAE,CAAC,SAAS,GAiCvD;kBAjCoB,cAAc","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class LoadingManager extends cc.Component {\r\n    @property(cc.ProgressBar)\r\n    progressBar: cc.ProgressBar = null;\r\n\r\n    @property(cc.Label)\r\n    percentLabel: cc.Label = null;\r\n\r\n    startLoading(targetScene: string) {\r\n    this.progressBar.progress = 0;\r\n    this.percentLabel.string = \"0%\";\r\n\r\n    cc.director.preloadScene(\r\n        targetScene,\r\n        (completedCount, totalCount, item) => {\r\n            let progress = completedCount / totalCount;\r\n            // 預設最多到 0.9，預留補滿動畫\r\n            if (progress > 0.9) progress = 0.9;\r\n            this.progressBar.progress = progress;\r\n            this.percentLabel.string = Math.floor(progress * 100) + \"%\";\r\n        },\r\n        () => {\r\n            // 預加載完成時，tween 補滿到 100%\r\n            cc.tween(this.progressBar)\r\n                .to(0.3, { progress: 1 })\r\n                .call(() => {\r\n                    this.percentLabel.string = \"100%\";\r\n                    cc.director.loadScene(targetScene);\r\n                })\r\n                .start();\r\n        });\r\n    }\r\n\r\n\r\n}\r\n\r\n"]}