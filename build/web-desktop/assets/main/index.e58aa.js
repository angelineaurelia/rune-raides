window.__require=function t(e,o,i){function n(r,c){if(!o[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var p="function"==typeof __require&&__require;if(!c&&p)return p(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var l=o[r]={exports:{}};e[r][0].call(l.exports,function(t){return n(e[r][1][t]||t)},l,l.exports,t,e,o,i)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<i.length;r++)n(i[r]);return n}({ActorController:[function(t,e,o){"use strict";cc._RF.push(e,"a55dft7PvVIPIFEJDrlEbfj","ActorController");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,c,s=t("./input/Controller"),p=t("./input/IInputControls"),l=cc._decorator,h=l.ccclass,u=l.property;(function(t){t[t.Idle=0]="Idle",t[t.Walk=1]="Walk",t[t.Attack=2]="Attack",t[t.Attack2=3]="Attack2",t[t.Attack3=4]="Attack3",t[t.Hurt=5]="Hurt",t[t.Die=6]="Die",t[t.Combo_1=7]="Combo_1"})(r||(r={})),function(t){t[t.Right=0]="Right",t[t.Left=1]="Left",t[t.Up=2]="Up",t[t.Down=3]="Down"}(c||(c={}));var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.initialFacingDirection=c.Right,e.player=null,e._animation=null,e._animState=null,e._rigidbody=null,e.idleAnimationName="",e.moveAnimationName="",e._idleAnimState=null,e._moveAnimState=null,e.walkRightAnimation="player_walk_right",e.walkLeftAnimation="player_walk_left",e.walkUpAnimation="player_walk_up",e.walkDownAnimation="player_walk_down",e.idleAnimation="player_standby",e.attack_right="attack_right-1",e.attack_left="attack_left-1",e.attack_up="attack_up-1",e.attack_down="attack_down-1",e.attack_right_2="attack_right-2",e.attack_left_2="attack_left-2",e.attack_up_2="attack_up-2",e.attack_down_2="attack_down-2",e.attack_right_3="attack_right-3",e.attack_left_3="attack_left-3",e.attack_up_3="attack_up-3",e.attack_down_3="attack_down-3",e.death_right="death_right",e.death_left="death_left",e.death_up="death_up",e.death_down="death_down",e.hurt_right="hurt_right",e.hurt_left="hurt_left",e.hurt_up="hurt_up",e.hurt_down="hurt_down",e.combo_right_1="combo-1_right",e.combo_left_1="combo-1_left",e.combo_up_1="combo-1_up",e.combo_down_1="combo-1_down",e.moveSpeed=20,e.moveAxisX=0,e.moveAxisY=0,e._playerState=r.Idle,e._facing=c.Down,e._lastAnim="",e.combostep=0,e.combotimer=0,e.comboInterval=1,e}return n(e,t),Object.defineProperty(e.prototype,"moveAxis2D",{get:function(){return new cc.Vec2(this.moveAxisX,this.moveAxisY)},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._animation=this.node.getComponent(cc.Animation),this._animation||console.warn("ActorController: Component cc.Animation missing on node "+this.node.name),this._rigidbody=this.node.getComponent(cc.RigidBody),this._rigidbody||console.warn("ActorController: Component cc.RigidBody missing on node "+this.node.name)},e.prototype.start=function(){t.prototype.start&&t.prototype.start.call(this),this._animation&&(this._idleAnimState=this._animation.getAnimationState(this.idleAnimationName),this._moveAnimState=this._animation.getAnimationState(this.moveAnimationName),this._animState=this._animation.play(this.idleAnimationName),this._animation.on("finished",this.onAnimFinished,this))},e.prototype.update=function(t){if(this._playerState!==r.Die&&(this.combostep>0&&(this.combotimer+=t,this.combotimer>=this.comboInterval&&(this.combostep=0)),this.inputSource)){if(this.incombo())return;this.moveAxisX=this.inputSource.horizontalAxis,this.moveAxisY=this.inputSource.verticalAxis;var e=this.moveAxis2D.mul(this.moveSpeed);this._rigidbody&&(this._rigidbody.linearVelocity=e);var o=this._animation.getAnimationState(this._lastAnim)&&this._animation.getAnimationState(this._lastAnim).isPlaying;0!==this.moveAxisX||0!==this.moveAxisY?(this._playerState=r.Walk,Math.abs(this.moveAxisX)>Math.abs(this.moveAxisY)?this._facing=this.moveAxisX>0?c.Right:c.Left:this._facing=this.moveAxisY>0?c.Up:c.Down):o?this.iswalking()&&(this._playerState=r.Idle):this._playerState=r.Idle,o&&this.incombo()||(this.inputSource.attack===p.ButtonState.Pressed?(this._playerState=r.Attack,this.player.getComponent("Player").playattack1sound()):this.inputSource.attack2===p.ButtonState.Pressed?(this._playerState=r.Attack2,this.player.getComponent("Player").playattack2sound()):this.inputSource.attack3===p.ButtonState.Pressed?(this._playerState=r.Attack3,this.player.getComponent("Player").playattack3sound()):this.inputSource.gethurt===p.ButtonState.Pressed&&(this._playerState=r.Hurt,this.player.getComponent("Player").takeDamage(5),this.inputSource._xKey=p.ButtonState.Held),this.incombo());var i=this.getAnimName(this._playerState,this._facing);this._animation&&i&&i!==this._lastAnim&&!this.stopupdate()&&(console.log(this._lastAnim,i),this._animState=this._animation.play(i),this._lastAnim=i),console.log(this._playerState,this._lastAnim,this.combostep,this.combotimer)}},e.prototype.getAnimName=function(t,e){switch(t){case r.Combo_1:switch(e){case c.Right:return this.combo_right_1;case c.Left:return this.combo_left_1;case c.Up:return this.combo_up_1;case c.Down:return this.combo_down_1}break;case r.Walk:switch(e){case c.Right:return this.walkRightAnimation;case c.Left:return this.walkLeftAnimation;case c.Up:return this.walkUpAnimation;case c.Down:return this.walkDownAnimation}break;case r.Idle:return this.idleAnimation;case r.Attack:switch(e){case c.Right:return this.attack_right;case c.Left:return this.attack_left;case c.Up:return this.attack_up;case c.Down:return this.attack_down}break;case r.Attack2:switch(e){case c.Right:return this.attack_right_2;case c.Left:return this.attack_left_2;case c.Up:return this.attack_up_2;case c.Down:return this.attack_down_2}break;case r.Attack3:switch(e){case c.Right:return this.attack_right_3;case c.Left:return this.attack_left_3;case c.Up:return this.attack_up_3;case c.Down:return this.attack_down_3}break;case r.Hurt:switch(e){case c.Right:return this.hurt_right;case c.Left:return this.hurt_left;case c.Up:return this.hurt_up;case c.Down:return this.hurt_down}break;case r.Die:switch(e){case c.Right:return this.death_right;case c.Left:return this.death_left;case c.Up:return this.death_up;case c.Down:return this.death_down}}return""},e.prototype.onAnimFinished=function(){console.log("finish"),this._playerState!==r.Attack&&this._playerState!==r.Attack2&&this._playerState!==r.Attack3&&this._playerState!==r.Hurt&&this._playerState!==r.Combo_1||(this._playerState=r.Idle,this._lastAnim="")},e.prototype.stopupdate=function(){for(var t=0,e=[this.combo_up_1,this.combo_down_1,this.combo_left_1,this.combo_right_1];t<e.length;t++){var o=e[t],i=this._animation.getAnimationState(o);if(i&&i.isPlaying)return!0}return!1},e.prototype.incombo=function(){return this._playerState===r.Combo_1||(this._playerState===r.Attack?(this.combostep=1,this.combotimer=0,!1):this._playerState===r.Attack2&&1===this.combostep&&this.combotimer<this.comboInterval?(this.combostep=2,this.combotimer=0,!1):this._playerState===r.Attack3&&2===this.combostep&&this.combotimer<this.comboInterval&&(this.combostep=3,this.combotimer=0,this._playerState=r.Combo_1,!0))},e.prototype.iswalking=function(){for(var t=0,e=[this.walkDownAnimation,this.walkLeftAnimation,this.walkRightAnimation,this.walkUpAnimation];t<e.length;t++){var o=e[t],i=this._animation.getAnimationState(o);if(i&&i.isPlaying)return!0}return!1},e.prototype.godie=function(){this._playerState=r.Die},a([u({type:cc.Enum(c)})],e.prototype,"initialFacingDirection",void 0),a([u(cc.Node)],e.prototype,"player",void 0),a([u(cc.String)],e.prototype,"idleAnimationName",void 0),a([u(cc.String)],e.prototype,"moveAnimationName",void 0),a([u(cc.String)],e.prototype,"walkRightAnimation",void 0),a([u(cc.String)],e.prototype,"walkLeftAnimation",void 0),a([u(cc.String)],e.prototype,"walkUpAnimation",void 0),a([u(cc.String)],e.prototype,"walkDownAnimation",void 0),a([u(cc.String)],e.prototype,"idleAnimation",void 0),a([u(cc.String)],e.prototype,"attack_right",void 0),a([u(cc.String)],e.prototype,"attack_left",void 0),a([u(cc.String)],e.prototype,"attack_up",void 0),a([u(cc.String)],e.prototype,"attack_down",void 0),a([u(cc.String)],e.prototype,"attack_right_2",void 0),a([u(cc.String)],e.prototype,"attack_left_2",void 0),a([u(cc.String)],e.prototype,"attack_up_2",void 0),a([u(cc.String)],e.prototype,"attack_down_2",void 0),a([u(cc.String)],e.prototype,"attack_right_3",void 0),a([u(cc.String)],e.prototype,"attack_left_3",void 0),a([u(cc.String)],e.prototype,"attack_up_3",void 0),a([u(cc.String)],e.prototype,"attack_down_3",void 0),a([u(cc.String)],e.prototype,"death_right",void 0),a([u(cc.String)],e.prototype,"death_left",void 0),a([u(cc.String)],e.prototype,"death_up",void 0),a([u(cc.String)],e.prototype,"death_down",void 0),a([u(cc.String)],e.prototype,"hurt_right",void 0),a([u(cc.String)],e.prototype,"hurt_left",void 0),a([u(cc.String)],e.prototype,"hurt_up",void 0),a([u(cc.String)],e.prototype,"hurt_down",void 0),a([u(cc.String)],e.prototype,"combo_right_1",void 0),a([u(cc.String)],e.prototype,"combo_left_1",void 0),a([u(cc.String)],e.prototype,"combo_up_1",void 0),a([u(cc.String)],e.prototype,"combo_down_1",void 0),a([u(cc.Float)],e.prototype,"moveSpeed",void 0),a([u(cc.Float)],e.prototype,"comboInterval",void 0),a([h],e)}(s.default);o.default=d,cc._RF.pop()},{"./input/Controller":"Controller","./input/IInputControls":"IInputControls"}],AgentStrategy:[function(t,e,o){"use strict";cc._RF.push(e,"3ea0em2sJxENZ80TS3fnUNO","AgentStrategy"),Object.defineProperty(o,"__esModule",{value:!0}),o.AI=void 0,(o.AI||(o.AI={})).Strategy=function(){},cc._RF.pop()},{}],Agent:[function(t,e,o){"use strict";cc._RF.push(e,"39ba77Ddy1EMpTOy+FEUQJ4","Agent");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,r=(a.ccclass,a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.update=function(t){this.agentUpdate(t)},e}(cc.Component));o.default=r,cc._RF.pop()},{}],AuthManager:[function(t,e,o){"use strict";cc._RF.push(e,"df599DLGEpEProbgXphfwt4","AuthManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.usernameEB=null,e.emailEB=null,e.pwdEB=null,e.saveBtn=null,e.exitBtn=null,e.auth=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.usernameEB=cc.find("UserName",this.node).getComponent(cc.EditBox),this.emailEB=cc.find("Email",this.node).getComponent(cc.EditBox),this.pwdEB=cc.find("Password",this.node).getComponent(cc.EditBox),this.saveBtn=cc.find("Save",this.node).getComponent(cc.Button),this.exitBtn=cc.find("Exit",this.node).getComponent(cc.Button),this.saveBtn.node.on("click",this.onSaveClicked,this),this.exitBtn.node.on("click",function(){return t.node.destroy()},this),window._firebaseInited||cc.error("Firebase not initialized! Make sure FirebaseInit is in your scene."),this.auth=firebase.auth()},e.prototype.onSaveClicked=function(){var t=this,e=this.usernameEB.string.trim(),o=this.emailEB.string.trim(),i=this.pwdEB.string;o&&i&&e?this.auth.createUserWithEmailAndPassword(o,i).then(function(t){return t.user.updateProfile({displayName:e})}).then(function(){cc.log("Signup succeeded:",e),t.showPopup("Signup Successful")}).catch(function(t){cc.error("Signup error:",t.code,t.message)}):cc.warn("All fields must be filled.")},e.prototype.showPopup=function(t){var e=this;cc.resources.load("prefabs/SuccessPopup",cc.Prefab,function(o,i){if(o)cc.error("Failed to load SuccessPopup:",o);else{var n=cc.instantiate(i);n.setPosition(0,0),n.zIndex=2e3,cc.find("Canvas").addChild(n);var a=n.getComponent("SuccessPopup");a.messageLabel.string=t,a.onOk=function(){e.node.destroy()}}})},a([c("AuthManager")],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],BlueSlimeAI:[function(t,e,o){"use strict";cc._RF.push(e,"93c17LsWWNNMIhlPghgF2vo","BlueSlimeAI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,c=cc._decorator,s=c.ccclass,p=c.property,l=t("../Player");(function(t){t[t.Idle=0]="Idle",t[t.Walk=1]="Walk",t[t.Run=2]="Run",t[t.Attack=3]="Attack"})(r||(r={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.walkSpeed=100,e.runSpeed=200,e.idleTime=5,e.walkTime=5,e.patrolRadius=200,e.detectionRadius=150,e.attackRadius=50,e.attackDamage=10,e.attackHitDelay=.3,e.attackAnimDuration=1,e.maxHealth=40,e.health=40,e.lifebar=null,e.barOffsetY=10,e.isDead=!1,e.isDeathAnimPlaying=!1,e.player=null,e.slimeState=r.Idle,e.timer=0,e.direction=cc.v2(0,0),e.patrolCenter=cc.v2(0,0),e.currentRunClip="",e.currentAttackClip="",e}return n(e,t),e.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0},e.prototype.start=function(){this.player=cc.find("Canvas/MapManager/Actors/Player"),this.player||cc.error("Player node not found"),this.anim=this.getComponent(cc.Animation),this.patrolCenter=this.node.getPosition().clone(),this.boundaryNode=new cc.Node("PatrolBoundary"),this.boundaryNode.parent=this.node.parent,this.boundaryNode.setPosition(this.patrolCenter);var t=this.boundaryNode.addComponent(cc.Graphics);t.lineWidth=2,t.strokeColor=cc.color(0,255,0),t.circle(0,0,this.patrolRadius),t.stroke(),this.detectionNode=new cc.Node("DetectionArea"),this.detectionNode.parent=this.node,this.detectionNode.setPosition(0,0),this.detectionGfx=this.detectionNode.addComponent(cc.Graphics),this.detectionGfx.lineWidth=2,this.attackNode=new cc.Node("AttackArea"),this.attackNode.parent=this.node,this.attackNode.setPosition(0,0),this.attackGfx=this.attackNode.addComponent(cc.Graphics),this.attackGfx.lineWidth=2,this.lifebar&&this.updateLife(0,40),this.setToIdle()},e.prototype.update=function(t){if(!this.isDead&&!this.isDeathAnimPlaying){var e=1/0;if(this.player){var o=this.node.parent.convertToWorldSpaceAR(this.node.position),i=this.player.parent.convertToWorldSpaceAR(this.player.position);e=o.sub(i).mag()}var n=this.node.parent.convertToNodeSpaceAR(this.player.parent.convertToWorldSpaceAR(this.player.position)).sub(this.patrolCenter).mag()<=this.patrolRadius,a=Math.min(this.detectionRadius,this.patrolRadius),c=Math.min(this.attackRadius,this.patrolRadius);this.detectionGfx.clear(),this.detectionGfx.lineWidth=2,this.detectionGfx.strokeColor=e<=this.detectionRadius?cc.color(255,165,0):cc.color(255,0,0),this.detectionGfx.circle(0,0,a),this.detectionGfx.stroke(),this.attackGfx.clear(),this.attackGfx.lineWidth=2,this.attackGfx.strokeColor=e<=this.attackRadius?cc.color(128,0,128):cc.color(0,0,255),this.attackGfx.circle(0,0,c),this.attackGfx.stroke();var s=e<=this.detectionRadius&&n;if(e<=this.attackRadius&&n&&this.slimeState!==r.Attack)this.startAttack();else{if(this.slimeState===r.Attack)return this.timer+=t,void(this.timer>=this.attackAnimDuration&&this.setToIdle());if(s)return this.slimeState!==r.Run&&this.startRunning(),void this.runTowardsPlayer(t);if(this.slimeState===r.Run&&this.setToIdle(),this.timer+=t,this.slimeState===r.Idle&&this.timer>=this.idleTime&&this.startWalking(),this.slimeState===r.Walk){var p=this.node.getPosition(),l=cc.v2(this.direction.x*this.walkSpeed*t,this.direction.y*this.walkSpeed*t),h=p.add(l);if(h.sub(this.patrolCenter).mag()>this.patrolRadius)return void this.setToIdle();this.node.setPosition(h),this.timer>=this.walkTime&&this.setToIdle()}}}},e.prototype.updateLife=function(t,e){this.lifebar&&(this.lifebar.width=e,this.lifebar.color=e<=10?cc.Color.RED:e<=20?cc.Color.ORANGE:cc.Color.GREEN)},e.prototype.takeDamage=function(t){if(!this.isDead&&!this.isDeathAnimPlaying){var e=this.player.getPosition(),o=this.node.getPosition(),i=e.sub(o).normalize(),n=Math.abs(i.x)>Math.abs(i.y)?i.x>0?"BlueSlimeHurtRight":"BlueSlimeHurtLeft":i.y>0?"BlueSlimeHurtUp":"BlueSlimeHurtDown";this.anim.play(n),this.health-=t,this.health<=0&&(this.health=0,this.isDeathAnimPlaying||(this.isDeathAnimPlaying=!0,this.playDeathAnimation(i))),this.updateLife(-t,this.health)}},e.prototype.heal=function(t){this.health+=t,this.health>this.maxHealth&&(this.health=this.maxHealth),this.updateLife(t,this.health)},e.prototype.die=function(){this.unscheduleAllCallbacks()},e.prototype.setToIdle=function(){this.slimeState=r.Idle,this.timer=0,this.anim.play("BlueSlimeIdle")},e.prototype.startWalking=function(){this.slimeState=r.Walk,this.timer=0,this.direction=cc.v2(Math.random()>=.5?1:-1,Math.random()>=.5?1:-1).normalize();var t=Math.abs(this.direction.x)>Math.abs(this.direction.y)?this.direction.x>0?"BlueSlimeWalkRight":"BlueSlimeWalkLeft":this.direction.y>0?"BlueSlimeWalkUp":"BlueSlimeWalkDown";this.anim.play(t)},e.prototype.startRunning=function(){this.slimeState=r.Run,this.currentRunClip=""},e.prototype.startAttack=function(){this.slimeState=r.Attack,this.timer=0,this.currentAttackClip="";var t=this.getRunDirection(),e=Math.abs(t.x)>Math.abs(t.y)?t.x>0?"BlueSlimeAttackRight":"BlueSlimeAttackLeft":t.y>0?"BlueSlimeAttackUp":"BlueSlimeAttackDown";this.anim.play(e),this.scheduleOnce(this.applyAttackHit,this.attackHitDelay)},e.prototype.applyAttackHit=function(){if(this.slimeState===r.Attack){var t=this.node.parent.convertToWorldSpaceAR(this.node.position),e=cc.v2(t.x,t.y),o=this.player.parent.convertToWorldSpaceAR(this.player.position),i=cc.v2(o.x,o.y);if(e.sub(i).mag()<=this.attackRadius){var n=this.player.getComponent(l.default);n&&n.takeDamage(this.attackDamage)}}},e.prototype.runTowardsPlayer=function(t){var e=this.getRunDirection(),o=Math.abs(e.x)>Math.abs(e.y)?e.x>0?"BlueSlimeRunRight":"BlueSlimeRunLeft":e.y>0?"BlueSlimeRunUp":"BlueSlimeRunDown";o!==this.currentRunClip&&(this.anim.play(o),this.currentRunClip=o);var i=cc.v2(e.x*this.runSpeed*t,e.y*this.runSpeed*t),n=this.node.getPosition().add(i);n.sub(this.patrolCenter).mag()>this.patrolRadius?this.setToIdle():this.node.setPosition(n)},e.prototype.getRunDirection=function(){var t=this.player.parent.convertToWorldSpaceAR(this.player.position),e=this.node.parent.convertToNodeSpaceAR(t);return cc.v2(e.x-this.node.x,e.y-this.node.y).normalize()},e.prototype.onDisable=function(){this.unscheduleAllCallbacks()},e.prototype.playDeathAnimation=function(t){var e=this,o=Math.abs(t.x)>Math.abs(t.y)?t.x>0?"BlueSlimeDeathRight":"BlueSlimeDeathLeft":t.y>0?"BlueSlimeDeathUp":"BlueSlimeDeathDown";this.anim.play(o),this.unscheduleAllCallbacks(),this.slimeState=r.Idle,this.scheduleOnce(function(){e.isDead=!0,e.isDeathAnimPlaying=!1},1)},a([p({tooltip:"Slime walk speed in pixels per second"})],e.prototype,"walkSpeed",void 0),a([p({tooltip:"Slime run speed in pixels per second"})],e.prototype,"runSpeed",void 0),a([p({tooltip:"How long the slime stays idle before walking (seconds)"})],e.prototype,"idleTime",void 0),a([p({tooltip:"How long the slime walks in one direction (seconds)"})],e.prototype,"walkTime",void 0),a([p({tooltip:"Patrol radius from start point (pixels)"})],e.prototype,"patrolRadius",void 0),a([p({tooltip:"Detection circle radius (pixels)"})],e.prototype,"detectionRadius",void 0),a([p({tooltip:"Attack circle radius (pixels)"})],e.prototype,"attackRadius",void 0),a([p({tooltip:"How much damage the slime does per attack"})],e.prototype,"attackDamage",void 0),a([p({type:cc.Float,tooltip:"Seconds into attack anim to apply damage"})],e.prototype,"attackHitDelay",void 0),a([p({type:cc.Float,tooltip:"Total length of attack anim (seconds)"})],e.prototype,"attackAnimDuration",void 0),a([p({tooltip:"Maximum health of the slime"})],e.prototype,"maxHealth",void 0),a([p({tooltip:"Current health of the slime"})],e.prototype,"health",void 0),a([p(cc.Node)],e.prototype,"lifebar",void 0),a([p({tooltip:"Vertical offset of health bar above slime (pixels)"})],e.prototype,"barOffsetY",void 0),a([s],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../Player":"Player"}],CameraTransposer:[function(t,e,o){"use strict";cc._RF.push(e,"4fc95uBgoFEs6B7ArEyrT0Q","CameraTransposer");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.followTarget=null,e.followX=!0,e.followY=!0,e.minX=-2147483647,e.minY=-2147483647,e.maxX=2147483647,e.maxY=2147483647,e.offsetX=0,e.offsetY=0,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(){var t=cc.mat4();this.node.getLocalMatrix(t);var e=cc.mat4();this.followTarget.getWorldMatrix(e);var o=cc.v3(0,0,0);e.getTranslation(o);var i=cc.v4(o.x,o.y,o.z).transformMat4(t),n=cc.v2(i.x,i.y).add(cc.v2(-cc.view.getDesignResolutionSize().width/2,-cc.view.getDesignResolutionSize().height/2));n=cc.v2(l(this.followX?n.x:this.node.position.x,this.minX,this.maxX),l(this.followY?n.y:this.node.position.y,this.minY,this.maxY)),this.node.position=n},a([s(cc.Node)],e.prototype,"followTarget",void 0),a([s(cc.Boolean)],e.prototype,"followX",void 0),a([s(cc.Boolean)],e.prototype,"followY",void 0),a([c],e)}(cc.Component);function l(t,e,o){return t<e?e:t>o?o:t}o.default=p,cc._RF.pop()},{}],Controller:[function(t,e,o){"use strict";cc._RF.push(e,"28ae2OQzsFN+6aNxTuvpevg","Controller");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var a=t("./IInputControls"),r=cc._decorator,c=(r.ccclass,r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputSource=null,e}return n(e,t),e.prototype.start=function(){this.registerInput(this.node.getComponents(cc.Component).find(function(t){return a.hasImplementedInputControls(t)}))},e.prototype.registerInput=function(t){null!==t&&(this.inputSource=t)},e}(cc.Component));o.default=c,cc._RF.pop()},{"./IInputControls":"IInputControls"}],Coward:[function(t,e,o){"use strict";cc._RF.push(e,"0f1e55DmctOVp8eQg/uquO9","Coward");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.Coward=void 0;var a=function(t){function e(e,o){var i=t.call(this)||this;return i._agent=null,i._runAwayFrom=null,i._moveAxis2D=cc.Vec2.ZERO,i._agent=e,i._runAwayFrom=o,i}return n(e,t),Object.defineProperty(e.prototype,"awayFromTarget",{get:function(){return this._agent.node.position.sub(this._runAwayFrom.position).normalize()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distanceFromTarget",{get:function(){return this._runAwayFrom.position.sub(this._agent.node.position).mag()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"horizontalAxis",{get:function(){return this._moveAxis2D.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAxis",{get:function(){return this._moveAxis2D.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attack",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"interact",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),e.prototype.start=function(){},e.prototype.update=function(){this._moveAxis2D=this.awayFromTarget},e}(t("./AgentStrategy").AI.Strategy);o.Coward=a,cc._RF.pop()},{"./AgentStrategy":"AgentStrategy"}],FirebaseInit:[function(t,e,o){"use strict";cc._RF.push(e,"906b6ZwtNJApoIUce17Hcz9","FirebaseInit");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator.ccclass,c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){window._firebaseInited||(firebase.initializeApp({apiKey:"AIzaSyDFW4-emWdI1ghgZWWGp1wqoWvAvTwAqrQ",authDomain:"rune-raids.firebaseapp.com",projectId:"rune-raids",storageBucket:"rune-raids.firebasestorage.app",messagingSenderId:"530514360843",appId:"1:530514360843:web:1cdda9d72bb4b52932250e",measurementId:"G-B1C5FG1YSN"}),window._firebaseInited=!0,cc.log("Firebase initialized"))},a([r("FirebaseInit")],e)}(cc.Component);o.default=c,cc._RF.pop()},{}],GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"89a10c6NgNMSaSJuLQEf/RT","GameManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgm=null,e.LevelLabel=null,e.maxhp=10,e.player=null,e.VolumnValue=null,e.Level=1,e}return n(e,t),e.prototype.onLoad=function(){var t=cc.find("Canvas/Main Camera/UI/Pause");if(t){var e=new cc.Component.EventHandler;e.target=this.node,e.component="GameManager",e.handler="PauseGame",t.getComponent(cc.Button).clickEvents.push(e)}else cc.error("Pause \u6309\u9215\u7bc0\u9ede\u627e\u4e0d\u5230\uff0c\u8acb\u6aa2\u67e5 Canvas/Main Camera/UI/Pause \u662f\u5426\u5b58\u5728\uff01");this.LevelLabel=cc.find("Canvas/Main Camera/UI/Level").getComponent(cc.Label),this.LevelLabel?this.LevelLabel.string="Level: "+this.Level:cc.error("Level label not found"),this.player=cc.find("Canvas/MapManager/Actors/Player"),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onDestroy=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onKeyDown=function(t){t.keyCode===cc.macro.KEY.space&&this.GoNextLevel()},e.prototype.start=function(){cc.director.getCollisionManager().enabled=!0;var t=cc.sys.localStorage.getItem("VolumnValue");this.VolumnValue=null!==t?Number(t):.5,cc.audioEngine.setEffectsVolume(this.VolumnValue),cc.audioEngine.setMusicVolume(this.VolumnValue),this.playMusic(),this.startGame()},e.prototype.PauseGame=function(){var t=this;console.log("Pause prefab load"),cc.resources.load("prefabs/PauseSetting",cc.Prefab,function(e,o){if(e)cc.error("Failed to load PauseSetting prefab:",e);else{var i=cc.instantiate(o);(c=cc.find("Canvas")).addChild(i),i.name="PauseSetting";var n=cc.find("Canvas/Main Camera");if(n){var a=n.convertToWorldSpaceAR(cc.Vec2.ZERO),r=c.convertToNodeSpaceAR(a);i.setPosition(r)}else cc.warn("\u627e\u4e0d\u5230 Main Camera\uff0c\u4f7f\u7528\u9810\u8a2d\u4f4d\u7f6e (0, 0)"),i.setPosition(0,0);i.scaleX=1,i.scaleY=1,cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,t.onKeyDown,t),cc.director.getScheduler().setTimeScale(0),cc.director.getPhysicsManager().enabled=!1;var c=cc.find("Canvas");t.PauseAllAnimation(c),t.initPause()}}),console.log("Pause prefab load...")},e.prototype.initPause=function(){var t=new cc.Component.EventHandler;t.target=this.node,t.component="GameManager",t.handler="ResumeGame",cc.find("Canvas/PauseSetting/Resume").getComponent(cc.Button).clickEvents.push(t);var e=cc.find("Canvas/PauseSetting/Volumn/VolumnSlider").getComponent(cc.Slider),o=cc.sys.localStorage.getItem("VolumnValue");e.progress=null!==o?Number(o):.5,e.node.on("slide",this.onVolumnChange,this);var i=new cc.Component.EventHandler;i.target=this.node,i.component="GameManager",i.handler="RestartGame",cc.find("Canvas/PauseSetting/Restart").getComponent(cc.Button).clickEvents.push(i);var n=new cc.Component.EventHandler;n.target=this.node,n.component="GameManager",n.handler="showDesc",cc.find("Canvas/PauseSetting/How").getComponent(cc.Button).clickEvents.push(n),cc.find("Canvas/PauseSetting/Description").active=!1;var a=new cc.Component.EventHandler;a.target=this.node,a.component="GameManager",a.handler="HideDesc",cc.find("Canvas/PauseSetting/Description/Exit").getComponent(cc.Button).clickEvents.push(a)},e.prototype.HideDesc=function(){cc.find("Canvas/PauseSetting/Description").active=!1},e.prototype.showDesc=function(){cc.find("Canvas/PauseSetting/Description").active=!0},e.prototype.RestartGame=function(){cc.director.getScheduler().setTimeScale(1),cc.director.getPhysicsManager().enabled=!0;var t=cc.find("Canvas");this.ResumeAllAnimation(t),cc.director.loadScene("Loading",function(){cc.find("Canvas/LoadingManager").getComponent("LoadingManager").startLoading("menu")});var e=cc.find("Canvas/Pausetting");e?e.destroy():cc.error("PauseSetting node not found")},e.prototype.ResumeGame=function(){var t=cc.find("Canvas/PauseSetting");t?t.destroy():cc.error("PauseSetting node not found"),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.director.getScheduler().setTimeScale(1),cc.director.getPhysicsManager().enabled=!0;var e=cc.find("Canvas");this.ResumeAllAnimation(e)},e.prototype.onVolumnChange=function(t){cc.audioEngine.setMusicVolume(t.progress),cc.audioEngine.setEffectsVolume(t.progress),this.VolumnValue=t.progress,cc.sys.localStorage.setItem("VolumnValue",this.VolumnValue.toString())},e.prototype.PauseAllAnimation=function(t){for(var e=0,o=t.getComponentsInChildren(cc.Animation);e<o.length;e++){var i=o[e];i?i.pause():cc.error("Animation component not found on node:",t.name)}for(var n=0,a=t.children;n<a.length;n++){var r=a[n];this.PauseAllAnimation(r)}},e.prototype.ResumeAllAnimation=function(t){for(var e=0,o=t.getComponentsInChildren(cc.Animation);e<o.length;e++){var i=o[e];i?i.resume():cc.error("Animation component not found on node:",t.name)}for(var n=0,a=t.children;n<a.length;n++){var r=a[n];this.ResumeAllAnimation(r)}},e.prototype.playMusic=function(){this.bgm?cc.audioEngine.playMusic(this.bgm,!0):cc.error("BGM not assigned!")},e.prototype.pauseMusic=function(){cc.audioEngine.pauseMusic()},e.prototype.resumeMusic=function(){cc.audioEngine.resumeMusic()},e.prototype.startGame=function(){this.Level=1,this.LevelLabel?this.LevelLabel.string="Level: "+this.Level:cc.error("Level Label not found"),this.player.getComponent("Player").SetPlayer(this.Level),cc.find("GameManager").getComponent("MapGenerator").GeneratorMap(),cc.find("Canvas/MapManager/MonsterManager").getComponent("MonsterManager").SetMonster(this.Level)},e.prototype.GoNextLevel=function(){this.Level++,this.LevelLabel?this.LevelLabel.string="Level: "+this.Level:cc.error("Level label not found");var t=cc.find("GameManager").getComponent("MapGenerator");t?t.regenerateMap(this.Level):cc.error("MapGenerator component not found"),this.player?this.player.getComponent("Player").SetPlayer(this.Level):cc.error("Player component not found"),cc.find("Canvas/MapManager/MonsterManager").getComponent("MonsterManager").SetMonster(this.Level);var e=cc.find("Canvas/Main Camera").getComponent(cc.Camera);e.zoomRatio=.9*e.zoomRatio;var o=cc.find("Canvas/Main Camera/UI");o?(o.setPosition(0,0),o.scaleX=1/e.zoomRatio,o.scaleY=1/e.zoomRatio):console.log("UI not found")},e.prototype.GameOver=function(){},a([s({type:cc.AudioClip})],e.prototype,"bgm",void 0),a([s(cc.Label)],e.prototype,"LevelLabel",void 0),a([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],GreenBossAI:[function(t,e,o){"use strict";cc._RF.push(e,"ddc97pf6D9J5rfmdoSlPhAP","GreenBossAI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,c=cc._decorator,s=c.ccclass,p=c.property;(function(t){t[t.Idle=0]="Idle",t[t.Walk=1]="Walk",t[t.Run=2]="Run",t[t.Attack=3]="Attack"})(r||(r={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.walkSpeed=100,e.runSpeed=200,e.idleTime=5,e.walkTime=5,e.patrolRadius=200,e.detectionRadius=150,e.attackRadius=50,e.specAttackRadius=100,e.timeBeforeAttack=1,e.attackDamage=20,e.specAttackDamage=40,e.maxHealth=200,e.health=200,e.lifebar=null,e.barOffsetY=60,e.player=null,e.state=r.Idle,e.timer=0,e.direction=cc.v2(0,0),e.currentRunClip="",e}return n(e,t),e.prototype.start=function(){this.player=cc.find("Canvas/MapManager/Actors/Player"),this.player||cc.error("Player node not found"),this.anim=this.getComponent(cc.Animation),this.patrolCenter=this.node.getPosition().clone(),this.boundaryNode=new cc.Node("Boundary"),this.boundaryNode.parent=this.node.parent,this.boundaryNode.setPosition(this.patrolCenter);var t=this.boundaryNode.addComponent(cc.Graphics);t.lineWidth=2,t.strokeColor=cc.color(0,255,0),t.circle(0,0,this.patrolRadius),t.stroke(),this.detectionNode=new cc.Node("Detect"),this.detectionNode.parent=this.node,this.detectionGfx=this.detectionNode.addComponent(cc.Graphics),this.detectionGfx.lineWidth=2,this.attackNode=new cc.Node("Attack"),this.attackNode.parent=this.node,this.attackGfx=this.attackNode.addComponent(cc.Graphics),this.attackGfx.lineWidth=2,this.lifebar&&(this.lifebar.setPosition(0,this.node.height/2+this.barOffsetY),this.updateLife(0,this.health)),this.setIdle()},e.prototype.update=function(t){if(this.player){var e=this.node.parent.convertToWorldSpaceAR(this.node.position),o=this.player.parent.convertToWorldSpaceAR(this.player.position),i=e.sub(o).mag(),n=this.node.parent.convertToNodeSpaceAR(o).sub(this.patrolCenter).mag()<=this.patrolRadius,a=this.health<=.5*this.maxHealth,c=a?this.specAttackRadius:this.attackRadius,s=Math.min(this.detectionRadius,this.patrolRadius),p=Math.min(c,this.patrolRadius);this.detectionGfx.clear();var l=i<=this.detectionRadius&&n;this.detectionGfx.strokeColor=l?cc.color(255,165,0):cc.color(255,0,0),this.detectionGfx.circle(0,0,s),this.detectionGfx.stroke(),this.attackGfx.clear();var h=i<=c&&n;if(this.attackGfx.strokeColor=h?cc.color(128,0,128):cc.color(0,0,255),this.attackGfx.circle(0,0,p),this.attackGfx.stroke(),this.state!==r.Attack&&h)return this.timer=0,void(a?this.startSpecAttack():this.startAttack());if(this.state!==r.Attack){if(l)return this.state!==r.Run&&this.startRun(),void this.runTowardsPlayer(t);this.state===r.Run&&this.setIdle(),this.timer+=t,this.state===r.Idle&&this.timer>=this.idleTime&&this.startWalk(),this.state===r.Walk&&this.patrolMovement(t)}}},e.prototype.updateLife=function(t,e){console.log("boss hp:",t,"\u2192",e),this.lifebar&&(this.lifebar.width=e,this.lifebar.color=e<=50?cc.Color.RED:e<=100?cc.Color.ORANGE:cc.Color.GREEN)},e.prototype.takeDamage=function(t){this.health-=t,this.health<0&&(this.health=0),this.updateLife(-t,this.health),0===this.health&&this.die()},e.prototype.die=function(){this.node.destroy()},e.prototype.setIdle=function(){this.state=r.Idle,this.timer=0,this.anim.play("GreenBossIdle")},e.prototype.startWalk=function(){this.state=r.Walk,this.timer=0,this.direction=cc.v2(Math.random()<.5?-1:1,Math.random()<.5?-1:1).normalize();var t=Math.abs(this.direction.x)>Math.abs(this.direction.y)?this.direction.x>0?"GreenBossWalkRight":"GreenBossWalkLeft":this.direction.y>0?"GreenBossWalkUp":"GreenBossWalkDown";this.anim.play(t)},e.prototype.startRun=function(){this.state=r.Run,this.currentRunClip=""},e.prototype.startAttack=function(){var t=this;this.state=r.Attack,this.anim.play("GreenBossIdle"),this.scheduleOnce(function(){return t.performAttack(t.attackDamage,t.attackRadius,"GreenBossAttack")},this.timeBeforeAttack)},e.prototype.startSpecAttack=function(){var t=this;this.state=r.Attack,this.anim.play("GreenBossIdle"),this.scheduleOnce(function(){return t.performAttack(t.specAttackDamage,t.specAttackRadius,"GreenBossSpecAttack")},this.timeBeforeAttack)},e.prototype.performAttack=function(t,e,o){var i=this,n=this.getRunDirection(),a=Math.abs(n.x)>Math.abs(n.y)?n.x>0?o+"Right":o+"Left":n.y>0?o+"Up":o+"Down";this.anim.play(a);var r=this.node.parent.convertToWorldSpaceAR(this.node.position),c=this.player.parent.convertToWorldSpaceAR(this.player.position);if(r.sub(c).mag()<=e){var s=this.player.getComponent("Health");(null==s?void 0:s.takeDamage)&&s.takeDamage(t)}this.scheduleOnce(function(){return i.setIdle()},1)},e.prototype.patrolMovement=function(t){var e=this.direction.mul(this.walkSpeed*t),o=this.node.getPosition().add(e);o.sub(this.patrolCenter).mag()>this.patrolRadius?this.setIdle():(this.node.setPosition(o),this.timer>=this.walkTime&&this.setIdle())},e.prototype.runTowardsPlayer=function(t){var e=this.getRunDirection(),o=Math.abs(e.x)>Math.abs(e.y)?e.x>0?"GreenBossRunRight":"GreenBossRunLeft":e.y>0?"GreenBossRunUp":"GreenBossRunDown";o!==this.currentRunClip&&(this.anim.play(o),this.currentRunClip=o);var i=this.node.getPosition().add(e.mul(this.runSpeed*t));i.sub(this.patrolCenter).mag()>this.patrolRadius?this.setIdle():this.node.setPosition(i)},e.prototype.getRunDirection=function(){var t=this.player.parent.convertToWorldSpaceAR(this.player.position),e=this.node.parent.convertToNodeSpaceAR(t);return cc.v2(e.x-this.node.x,e.y-this.node.y).normalize()},a([p({tooltip:"Walk speed in pixels/sec"})],e.prototype,"walkSpeed",void 0),a([p({tooltip:"Run speed in pixels/sec"})],e.prototype,"runSpeed",void 0),a([p({tooltip:"Idle duration before moving (sec)"})],e.prototype,"idleTime",void 0),a([p({tooltip:"Walk duration per direction (sec)"})],e.prototype,"walkTime",void 0),a([p({tooltip:"Patrol radius from start (px)"})],e.prototype,"patrolRadius",void 0),a([p({tooltip:"Detection radius (px)"})],e.prototype,"detectionRadius",void 0),a([p({tooltip:"Normal attack radius (px)"})],e.prototype,"attackRadius",void 0),a([p({tooltip:"Special attack radius when <50% HP (px)"})],e.prototype,"specAttackRadius",void 0),a([p({tooltip:"Wind-up before any attack (sec)"})],e.prototype,"timeBeforeAttack",void 0),a([p({tooltip:"Damage of normal attack"})],e.prototype,"attackDamage",void 0),a([p({tooltip:"Damage of special attack"})],e.prototype,"specAttackDamage",void 0),a([p({tooltip:"Max HP"})],e.prototype,"maxHealth",void 0),a([p({tooltip:"Current HP"})],e.prototype,"health",void 0),a([p(cc.Node)],e.prototype,"lifebar",void 0),a([p({tooltip:"Health bar vertical offset (px)"})],e.prototype,"barOffsetY",void 0),a([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],GreenSlimeAI:[function(t,e,o){"use strict";cc._RF.push(e,"83760YFIXRPyL+YhejhNquq","GreenSlimeAI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,c=cc._decorator,s=c.ccclass,p=c.property;(function(t){t[t.Idle=0]="Idle",t[t.Walk=1]="Walk",t[t.Run=2]="Run",t[t.Attack=3]="Attack"})(r||(r={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.walkSpeed=100,e.runSpeed=200,e.idleTime=5,e.walkTime=5,e.patrolRadius=200,e.detectionRadius=150,e.attackRadius=50,e.maxHealth=100,e.health=100,e.lifebar=null,e.barOffsetY=10,e.player=null,e.slimeState=r.Idle,e.timer=0,e.direction=cc.v2(0,0),e.patrolCenter=cc.v2(0,0),e.currentRunClip="",e.currentAttackClip="",e}return n(e,t),e.prototype.onLoad=function(){this.player||(this.player=cc.find("Canvas/MapManager/Actors/Player"),this.player||cc.error("Couldn\u2019t find Player at MapManager/Actors/Player"))},e.prototype.start=function(){this.player=cc.find("Canvas/MapManager/Actors/Player"),this.player||cc.error("Player node not found"),this.anim=this.getComponent(cc.Animation),this.patrolCenter=this.node.getPosition().clone(),this.boundaryNode=new cc.Node("PatrolBoundary"),this.boundaryNode.parent=this.node.parent,this.boundaryNode.setPosition(this.patrolCenter);var t=this.boundaryNode.addComponent(cc.Graphics);t.lineWidth=2,t.strokeColor=cc.color(0,255,0),t.circle(0,0,this.patrolRadius),t.stroke(),this.detectionNode=new cc.Node("DetectionArea"),this.detectionNode.parent=this.node,this.detectionNode.setPosition(0,0),this.detectionGfx=this.detectionNode.addComponent(cc.Graphics),this.detectionGfx.lineWidth=2,this.attackNode=new cc.Node("AttackArea"),this.attackNode.parent=this.node,this.attackNode.setPosition(0,0),this.attackGfx=this.attackNode.addComponent(cc.Graphics),this.attackGfx.lineWidth=2,this.lifebar&&(this.lifebar.setPosition(0,this.node.height/2+this.barOffsetY),this.updateLife(0,this.health)),this.setToIdle()},e.prototype.update=function(t){var e=1/0;if(this.player){var o=this.node.parent.convertToWorldSpaceAR(this.node.position),i=this.player.parent.convertToWorldSpaceAR(this.player.position);e=o.sub(i).mag()}var n=this.node.parent.convertToNodeSpaceAR(this.player.parent.convertToWorldSpaceAR(this.player.position)).sub(this.patrolCenter).mag()<=this.patrolRadius,a=Math.min(this.detectionRadius,this.patrolRadius),c=Math.min(this.attackRadius,this.patrolRadius);this.detectionGfx.clear(),this.detectionGfx.lineWidth=2,this.detectionGfx.strokeColor=e<=this.detectionRadius?cc.color(255,165,0):cc.color(255,0,0),this.detectionGfx.circle(0,0,a),this.detectionGfx.stroke(),this.attackGfx.clear(),this.attackGfx.lineWidth=2,this.attackGfx.strokeColor=e<=this.attackRadius?cc.color(128,0,128):cc.color(0,0,255),this.attackGfx.circle(0,0,c),this.attackGfx.stroke();var s=e<=this.detectionRadius&&n;if(e<=this.attackRadius&&n&&this.slimeState!==r.Attack)this.startAttack();else{if(this.slimeState===r.Attack)return this.timer+=t,void(this.timer>=1&&this.setToIdle());if(s)return this.slimeState!==r.Run&&this.startRunning(),void this.runTowardsPlayer(t);if(this.slimeState===r.Run&&this.setToIdle(),this.timer+=t,this.slimeState===r.Idle&&this.timer>=this.idleTime&&this.startWalking(),this.slimeState===r.Walk){var p=this.node.getPosition(),l=cc.v2(this.direction.x*this.walkSpeed*t,this.direction.y*this.walkSpeed*t),h=p.add(l);if(h.sub(this.patrolCenter).mag()>this.patrolRadius)return void this.setToIdle();this.node.setPosition(h),this.timer>=this.walkTime&&this.setToIdle()}}},e.prototype.updateLife=function(t,e){console.log("slime life change:",t,"\u2192",e),this.lifebar&&(this.lifebar.width=e,this.lifebar.color=e<=10?cc.Color.RED:e<=20?cc.Color.ORANGE:cc.Color.GREEN)},e.prototype.takeDamage=function(t){this.health-=t,this.health<0&&(this.health=0),this.updateLife(-t,this.health),0===this.health&&this.die()},e.prototype.heal=function(t){this.health+=t,this.health>this.maxHealth&&(this.health=this.maxHealth),this.updateLife(t,this.health)},e.prototype.die=function(){this.node.destroy()},e.prototype.setToIdle=function(){this.slimeState=r.Idle,this.timer=0,this.anim.play("GreeenSlimeIdle")},e.prototype.startWalking=function(){this.slimeState=r.Walk,this.timer=0,this.direction=cc.v2(Math.random()>=.5?1:-1,Math.random()>=.5?1:-1).normalize();var t=Math.abs(this.direction.x)>Math.abs(this.direction.y)?this.direction.x>0?"GreeenSlimeWalkRight":"GreeenSlimeWalkLeft":this.direction.y>0?"GreeenSlimeWalkUp":"GreeenSlimeWalkDown";this.anim.play(t)},e.prototype.startRunning=function(){this.slimeState=r.Run,this.currentRunClip=""},e.prototype.startAttack=function(){this.slimeState=r.Attack,this.timer=0,this.currentAttackClip="";var t=this.getRunDirection(),e=Math.abs(t.x)>Math.abs(t.y)?t.x>0?"GreeenSlimeAttackRight":"GreeenSlimeAttackLeft":t.y>0?"GreeenSlimeAttackUp":"GreeenSlimeAttackDown";this.anim.play(e)},e.prototype.runTowardsPlayer=function(t){var e=this.getRunDirection(),o=Math.abs(e.x)>Math.abs(e.y)?e.x>0?"GreeenSlimeRunRight":"GreeenSlimeRunLeft":e.y>0?"GreeenSlimeRunUp":"GreeenSlimeRunDown";o!==this.currentRunClip&&(this.anim.play(o),this.currentRunClip=o);var i=cc.v2(e.x*this.runSpeed*t,e.y*this.runSpeed*t),n=this.node.getPosition().add(i);n.sub(this.patrolCenter).mag()>this.patrolRadius?this.setToIdle():this.node.setPosition(n)},e.prototype.getRunDirection=function(){var t=this.player.parent.convertToWorldSpaceAR(this.player.position),e=this.node.parent.convertToNodeSpaceAR(t);return cc.v2(e.x-this.node.x,e.y-this.node.y).normalize()},a([p({tooltip:"Slime walk speed in pixels per second"})],e.prototype,"walkSpeed",void 0),a([p({tooltip:"Slime run speed in pixels per second"})],e.prototype,"runSpeed",void 0),a([p({tooltip:"How long the slime stays idle before walking (seconds)"})],e.prototype,"idleTime",void 0),a([p({tooltip:"How long the slime walks in one direction (seconds)"})],e.prototype,"walkTime",void 0),a([p({tooltip:"Patrol radius from start point (pixels)"})],e.prototype,"patrolRadius",void 0),a([p({tooltip:"Detection circle radius (pixels)"})],e.prototype,"detectionRadius",void 0),a([p({tooltip:"Attack circle radius (pixels)"})],e.prototype,"attackRadius",void 0),a([p({tooltip:"Maximum health of the slime"})],e.prototype,"maxHealth",void 0),a([p({tooltip:"Current health of the slime"})],e.prototype,"health",void 0),a([p(cc.Node)],e.prototype,"lifebar",void 0),a([p({tooltip:"Vertical offset of health bar above slime (pixels)"})],e.prototype,"barOffsetY",void 0),a([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],IInputControls:[function(t,e,o){"use strict";cc._RF.push(e,"5cb1e/x681EIqL7dYrX+sTd","IInputControls"),Object.defineProperty(o,"__esModule",{value:!0}),o.hasImplementedInputControls=o.ButtonState=void 0,function(t){t[t.Rest=0]="Rest",t[t.Pressed=1]="Pressed",t[t.Held=2]="Held",t[t.Released=3]="Released"}(o.ButtonState||(o.ButtonState={})),o.hasImplementedInputControls=function(t){return t&&void 0!==t.horizontalAxis&&void 0!==t.verticalAxis&&void 0!==t.attack&&void 0!==t.interact&&void 0!==t.gethurt&&void 0!==t.attack2&&void 0!==t.attack3},cc._RF.pop()},{}],KeyboardControls:[function(t,e,o){"use strict";cc._RF.push(e,"2ff4dcmThZMKKaXEWb71524","KeyboardControls");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./IInputControls"),c=cc._decorator,s=c.ccclass,p=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._hAxis=0,e._vAxis=0,e._zKey=r.ButtonState.Rest,e._xKey=r.ButtonState.Rest,e._cKey=r.ButtonState.Rest,e._vKey=r.ButtonState.Rest,e}return n(e,t),Object.defineProperty(e.prototype,"horizontalAxis",{get:function(){return this._hAxis},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAxis",{get:function(){return this._vAxis},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attack",{get:function(){return this._zKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"interact",{get:function(){return this._zKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gethurt",{get:function(){return this._xKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attack2",{get:function(){return this._cKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attack3",{get:function(){return this._vKey},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){},e.prototype.start=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.a:this._hAxis=-1;break;case cc.macro.KEY.d:this._hAxis=1;break;case cc.macro.KEY.w:this._vAxis=1;break;case cc.macro.KEY.s:this._vAxis=-1;break;case cc.macro.KEY.z:this._zKey===r.ButtonState.Rest||this._zKey===r.ButtonState.Released?this._zKey=r.ButtonState.Pressed:this._zKey=r.ButtonState.Held;break;case cc.macro.KEY.x:this._xKey===r.ButtonState.Rest||this._xKey===r.ButtonState.Released?this._xKey=r.ButtonState.Pressed:this._xKey=r.ButtonState.Held;break;case cc.macro.KEY.c:this._cKey===r.ButtonState.Rest||this._cKey===r.ButtonState.Released?this._cKey=r.ButtonState.Pressed:this._cKey=r.ButtonState.Held;break;case cc.macro.KEY.v:this._vKey===r.ButtonState.Rest||this._vKey===r.ButtonState.Released?this._vKey=r.ButtonState.Pressed:this._vKey=r.ButtonState.Held}this._vAxis=l(this._vAxis),this._hAxis=l(this._hAxis)},e.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.a:this._hAxis+=1;break;case cc.macro.KEY.d:this._hAxis-=1;break;case cc.macro.KEY.w:this._vAxis-=1;break;case cc.macro.KEY.s:this._vAxis+=1;break;case cc.macro.KEY.z:this._zKey===r.ButtonState.Pressed||this._zKey===r.ButtonState.Held?this._zKey=r.ButtonState.Released:this._zKey=r.ButtonState.Rest;break;case cc.macro.KEY.x:this._xKey===r.ButtonState.Pressed||this._xKey===r.ButtonState.Held?this._xKey=r.ButtonState.Released:this._xKey=r.ButtonState.Rest;break;case cc.macro.KEY.c:this._cKey===r.ButtonState.Pressed||this._cKey===r.ButtonState.Held?this._cKey=r.ButtonState.Released:this._cKey=r.ButtonState.Rest;break;case cc.macro.KEY.v:this._vKey===r.ButtonState.Pressed||this._vKey===r.ButtonState.Held?this._vKey=r.ButtonState.Released:this._vKey=r.ButtonState.Rest}this._vAxis=l(this._vAxis),this._hAxis=l(this._hAxis)},a([s],e)}(cc.Component));function l(t,e,o){return void 0===e&&(e=-1),void 0===o&&(o=1),t<e?e:t>o?o:t}o.default=p,cc._RF.pop()},{"./IInputControls":"IInputControls"}],Key:[function(t,e,o){"use strict";cc._RF.push(e,"793feh1sfZEEYJ5zYzkepR2","Key");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e.anim=null,e}return n(e,t),e.prototype.start=function(){this.anim=this.getComponent(cc.Animation)},e.prototype.update=function(){this.anim.getAnimationState("key-gold").isPlaying||this.anim.play("key-gold")},a([s(cc.Label)],e.prototype,"label",void 0),a([s],e.prototype,"text",void 0),a([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],LavaSlimeAI:[function(t,e,o){"use strict";cc._RF.push(e,"8da08N+F15AyKvgv89aNhm3","LavaSlimeAI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,c=cc._decorator,s=c.ccclass,p=c.property;(function(t){t[t.Idle=0]="Idle",t[t.Walk=1]="Walk",t[t.Run=2]="Run",t[t.Attack=3]="Attack"})(r||(r={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.walkSpeed=100,e.runSpeed=200,e.idleTime=5,e.walkTime=5,e.patrolRadius=200,e.detectionRadius=150,e.attackRadius=50,e.timeBeforeAttack=1,e.attackDamage=20,e.maxHealth=100,e.health=100,e.lifebar=null,e.barOffsetY=50,e.player=null,e.slimeState=r.Idle,e.timer=0,e.direction=cc.v2(0,0),e.patrolCenter=cc.v2(0,0),e.currentRunClip="",e.currentAttackClip="",e}return n(e,t),e.prototype.start=function(){this.player=cc.find("Canvas/MapManager/Actors/Player"),this.player||cc.error("Player node not found"),this.anim=this.getComponent(cc.Animation),this.patrolCenter=this.node.getPosition().clone(),this.boundaryNode=new cc.Node("PatrolBoundary"),this.boundaryNode.parent=this.node.parent,this.boundaryNode.setPosition(this.patrolCenter);var t=this.boundaryNode.addComponent(cc.Graphics);t.lineWidth=2,t.strokeColor=cc.color(0,255,0),t.circle(0,0,this.patrolRadius),t.stroke(),this.detectionNode=new cc.Node("DetectionArea"),this.detectionNode.parent=this.node,this.detectionNode.setPosition(0,0),this.detectionGfx=this.detectionNode.addComponent(cc.Graphics),this.detectionGfx.lineWidth=2,this.attackNode=new cc.Node("AttackArea"),this.attackNode.parent=this.node,this.attackNode.setPosition(0,0),this.attackGfx=this.attackNode.addComponent(cc.Graphics),this.attackGfx.lineWidth=2,this.lifebar&&(this.lifebar.setPosition(0,this.node.height/2+this.barOffsetY),this.updateLife(0,this.health)),this.setToIdle()},e.prototype.update=function(t){var e=1/0;if(this.player){var o=this.node.parent.convertToWorldSpaceAR(this.node.position),i=this.player.parent.convertToWorldSpaceAR(this.player.position);e=o.sub(i).mag()}var n=this.node.parent.convertToNodeSpaceAR(this.player.parent.convertToWorldSpaceAR(this.player.position)).sub(this.patrolCenter).mag()<=this.patrolRadius,a=Math.min(this.detectionRadius,this.patrolRadius);this.detectionGfx.clear(),this.detectionGfx.lineWidth=2,this.detectionGfx.strokeColor=e<=this.detectionRadius?cc.color(255,165,0):cc.color(255,0,0),this.detectionGfx.circle(0,0,a),this.detectionGfx.stroke();var c=Math.min(this.attackRadius,this.patrolRadius);this.attackGfx.clear(),this.attackGfx.lineWidth=2,this.attackGfx.strokeColor=e<=this.attackRadius?cc.color(128,0,128):cc.color(0,0,255),this.attackGfx.circle(0,0,c),this.attackGfx.stroke();var s=e<=this.detectionRadius&&n;if(e<=this.attackRadius&&n&&this.slimeState!==r.Attack)this.startAttack();else{if(this.slimeState===r.Attack)return this.timer+=t,void(this.timer>=this.timeBeforeAttack+1&&this.setToIdle());if(s)return this.slimeState!==r.Run&&this.startRunning(),void this.runTowardsPlayer(t);if(this.slimeState===r.Run&&this.setToIdle(),this.timer+=t,this.slimeState===r.Idle&&this.timer>=this.idleTime&&this.startWalking(),this.slimeState===r.Walk){var p=this.node.getPosition(),l=cc.v2(this.direction.x*this.walkSpeed*t,this.direction.y*this.walkSpeed*t),h=p.add(l);if(h.sub(this.patrolCenter).mag()>this.patrolRadius)return void this.setToIdle();this.node.setPosition(h),this.timer>=this.walkTime&&this.setToIdle()}}},e.prototype.updateLife=function(t,e){console.log("lava slime hp:",t,"\u2192",e),this.lifebar&&(this.lifebar.width=e,this.lifebar.color=e<=10?cc.Color.RED:e<=20?cc.Color.ORANGE:cc.Color.GREEN)},e.prototype.takeDamage=function(t){this.health-=t,this.health<0&&(this.health=0),this.updateLife(-t,this.health),0===this.health&&this.die()},e.prototype.heal=function(t){this.health+=t,this.health>this.maxHealth&&(this.health=this.maxHealth),this.updateLife(t,this.health)},e.prototype.die=function(){this.node.destroy()},e.prototype.setToIdle=function(){this.slimeState=r.Idle,this.timer=0,this.anim.play("LavaSlimeIdle")},e.prototype.startWalking=function(){this.slimeState=r.Walk,this.timer=0,this.direction=cc.v2(Math.random()>=.5?1:-1,Math.random()>=.5?1:-1).normalize();var t=Math.abs(this.direction.x)>Math.abs(this.direction.y)?this.direction.x>0?"LavaSlimeWalkRight":"LavaSlimeWalkLeft":this.direction.y>0?"LavaSlimeWalkUp":"LavaSlimeWalkDown";this.anim.play(t)},e.prototype.startRunning=function(){this.slimeState=r.Run,this.currentRunClip=""},e.prototype.startAttack=function(){var t=this;this.slimeState=r.Attack,this.timer=0,this.anim.play("LavaSlimeIdle"),this.scheduleOnce(function(){return t.performAttack()},this.timeBeforeAttack)},e.prototype.performAttack=function(){var t=this,e=this.getRunDirection(),o=Math.abs(e.x)>Math.abs(e.y)?e.x>0?"LavaSlimeAttackRight":"LavaSlimeAttackLeft":e.y>0?"LavaSlimeAttackUp":"LavaSlimeAttackDown";this.anim.play(o),this.applyAttackDamage(),this.scheduleOnce(function(){return t.setToIdle()},1)},e.prototype.runTowardsPlayer=function(t){var e=this.getRunDirection(),o=Math.abs(e.x)>Math.abs(e.y)?e.x>0?"LavaSlimeRunRight":"LavaSlimeRunLeft":e.y>0?"LavaSlimeRunUp":"LavaSlimeRunDown";o!==this.currentRunClip&&(this.anim.play(o),this.currentRunClip=o);var i=cc.v2(e.x*this.runSpeed*t,e.y*this.runSpeed*t),n=this.node.getPosition().add(i);n.sub(this.patrolCenter).mag()>this.patrolRadius?this.setToIdle():this.node.setPosition(n)},e.prototype.getRunDirection=function(){var t=this.player.parent.convertToWorldSpaceAR(this.player.position),e=this.node.parent.convertToNodeSpaceAR(t);return cc.v2(e.x-this.node.x,e.y-this.node.y).normalize()},e.prototype.applyAttackDamage=function(){if(this.player){var t=this.player.getComponent("Health");t&&"function"==typeof t.takeDamage&&t.takeDamage(this.attackDamage)}},a([p({tooltip:"Slime walk speed in pixels per second"})],e.prototype,"walkSpeed",void 0),a([p({tooltip:"Slime run speed in pixels per second"})],e.prototype,"runSpeed",void 0),a([p({tooltip:"How long the slime stays idle before walking (seconds)"})],e.prototype,"idleTime",void 0),a([p({tooltip:"How long the slime walks in one direction (seconds)"})],e.prototype,"walkTime",void 0),a([p({tooltip:"Patrol radius from start point (pixels)"})],e.prototype,"patrolRadius",void 0),a([p({tooltip:"Detection circle radius (pixels)"})],e.prototype,"detectionRadius",void 0),a([p({tooltip:"Attack circle radius (pixels)"})],e.prototype,"attackRadius",void 0),a([p({tooltip:"Time to wait before performing attack (seconds)"})],e.prototype,"timeBeforeAttack",void 0),a([p({tooltip:"Damage dealt by the attack"})],e.prototype,"attackDamage",void 0),a([p({tooltip:"Maximum health of the slime"})],e.prototype,"maxHealth",void 0),a([p({tooltip:"Current health of the slime"})],e.prototype,"health",void 0),a([p(cc.Node)],e.prototype,"lifebar",void 0),a([p({tooltip:"Vertical offset of health bar above slime (pixels)"})],e.prototype,"barOffsetY",void 0),a([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],LoadingManager:[function(t,e,o){"use strict";cc._RF.push(e,"7aec4WHPZxHE4ps/5MxYjR7","LoadingManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progressBar=null,e.percentLabel=null,e}return n(e,t),e.prototype.startLoading=function(t){var e=this;this.progressBar.progress=0,this.percentLabel.string="0%",cc.director.preloadScene(t,function(t,o){var i=t/o;i>.9&&(i=.9),e.progressBar.progress=i,e.percentLabel.string=Math.floor(100*i)+"%"},function(){cc.tween(e.progressBar).to(.3,{progress:1}).call(function(){e.percentLabel.string="100%",cc.director.loadScene(t)}).start()})},a([s(cc.ProgressBar)],e.prototype,"progressBar",void 0),a([s(cc.Label)],e.prototype,"percentLabel",void 0),a([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],Lock:[function(t,e,o){"use strict";cc._RF.push(e,"968b4LLZBJDy78DLuhX3gwV","Lock");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e.anim=null,e}return n(e,t),e.prototype.start=function(){this.anim=this.getComponent(cc.Animation)},e.prototype.playAnim=function(){this.anim.getAnimationState("Lock-pink").isPlaying||this.anim.play("Lock-pink")},a([s(cc.Label)],e.prototype,"label",void 0),a([s],e.prototype,"text",void 0),a([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],MapGeneratorCore:[function(t,e,o){"use strict";cc._RF.push(e,"67e35QjBHdNv7coHUqfA/Sf","MapGeneratorCore"),Object.defineProperty(o,"__esModule",{value:!0}),o.Map_Graph=o.mapRoomUnit=o.Map_selected_edge=o.Map_edge=o.Map_node=void 0;var i=function(t){this.disjoint_set_height=1,this.disjoint_set_ptr=t};o.Map_node=i;var n=function(t,e){this.from=t,this.to=e,this.weight=Math.random()};o.Map_edge=n;var a=function(t,e){this.from=t,this.to=e};o.Map_selected_edge=a;var r=function(t){this.up=t,this.down=t,this.right=t,this.left=t};o.mapRoomUnit=r;var c=function(){function t(t,e){this.vertexList=new Map,this.edgeList=[],this.selectedEdgeList=[],this.mapBlock=[],this.ymax=e,this.xmax=t;for(var o=0;o<this.ymax;o+=1){this.mapBlock[o]=[];for(var i=0;i<this.xmax;i+=1)this.mapBlock[o][i]=new r(!0)}this.initializeGraph()}return t.prototype.disjoint_set_top=function(t){for(;;){if(void 0===this.vertexList.get(t))return-1;if(t===this.vertexList.get(t).disjoint_set_ptr)return t;t=this.vertexList.get(t).disjoint_set_ptr}},t.prototype.initializeGraph=function(){for(var t=0;t<this.xmax;t+=1)for(var e=0;e<this.ymax;e+=1){var o=t+e*this.xmax,a=new i(o);this.vertexList.set(o,a)}for(t=0;t<this.xmax-1;t+=1)for(e=0;e<this.ymax;e+=1)if(o=t+e*this.xmax,void 0!==this.vertexList.get(o)&&void 0!==this.vertexList.get(o+1)){var r=new n(o,o+1);this.edgeList.push(r)}for(t=0;t<this.xmax;t+=1)for(e=0;e<this.ymax-1;e+=1)o=t+e*this.xmax,void 0!==this.vertexList.get(o)&&void 0!==this.vertexList.get(o+this.xmax)&&(r=new n(o,o+this.xmax),this.edgeList.push(r));this.edgeList.sort(function(t,e){return t.weight-e.weight}),this.calculateMinimumSpanningTree(),this.calculate_block()},t.prototype.calculate_block=function(){for(var t=0;t<this.selectedEdgeList.length;t++)if(this.selectedEdgeList[t].to-this.selectedEdgeList[t].from==1){var e=this.selectedEdgeList[t].from%this.xmax,o=(this.selectedEdgeList[t].from-e)/this.xmax;this.mapBlock[o][e].right=!1,this.mapBlock[o][e+1].left=!1}else e=this.selectedEdgeList[t].from%this.xmax,o=(this.selectedEdgeList[t].from-e)/this.xmax,this.mapBlock[o][e].down=!1,this.mapBlock[o+1][e].up=!1},t.prototype.calculateMinimumSpanningTree=function(){for(var t=0;t<this.edgeList.length;t++)if(this.disjoint_set_top(this.edgeList[t].from)!==this.disjoint_set_top(this.edgeList[t].to)){var e=new a(this.edgeList[t].from,this.edgeList[t].to);this.selectedEdgeList.push(e);var o=this.disjoint_set_top(this.edgeList[t].from),i=this.disjoint_set_top(this.edgeList[t].to);this.vertexList.get(o).disjoint_set_height===this.vertexList.get(i).disjoint_set_height?(this.vertexList.get(i).disjoint_set_ptr=o,this.vertexList.get(o).disjoint_set_height+=1):this.vertexList.get(o).disjoint_set_height>this.vertexList.get(i).disjoint_set_height?this.vertexList.get(i).disjoint_set_ptr=o:this.vertexList.get(o).disjoint_set_ptr=i}},t}();o.Map_Graph=c,cc._RF.pop()},{}],MapGenerator:[function(t,e,o){"use strict";cc._RF.push(e,"c99a3fycmhINqcjJAb8dgD/","MapGenerator");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=t("./MapGeneratorCore"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wallList=null,e.verticalWallPrefab=null,e.horizontalWallPrefab=null,e.keyToNextLevel=null,e.lockToNextLevel=null,e.myMap=null,e.Map_xmax=10,e.Map_ymax=5,e.blocksize_x=100,e.blocksize_y=100,e}return n(e,t),Object.defineProperty(e.prototype,"MapXmax",{get:function(){return this.Map_xmax*this.blocksize_x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MapYmax",{get:function(){return this.Map_ymax*this.blocksize_y},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){},e.prototype.GeneratorMap=function(){this.myMap=new p.Map_Graph(this.Map_xmax,this.Map_ymax);for(var t=0;t<this.Map_xmax;t++)for(var e=0;e<this.Map_ymax;e++)this.myMap.mapBlock[e][t].up&&((i=cc.instantiate(this.horizontalWallPrefab)).setPosition(t*this.blocksize_x,e*this.blocksize_y),this.wallList.addChild(i,1,"wall")),this.myMap.mapBlock[e][t].left&&((i=cc.instantiate(this.verticalWallPrefab)).setPosition(t*this.blocksize_x,e*this.blocksize_y),this.wallList.addChild(i,1,"wall"));for(var o=0;o<this.Map_xmax;o++)(i=cc.instantiate(this.horizontalWallPrefab)).setPosition(o*this.blocksize_x,this.Map_ymax*this.blocksize_y),this.wallList.addChild(i,1,"wall");for(o=0;o<this.Map_ymax;o++){var i;(i=cc.instantiate(this.verticalWallPrefab)).setPosition(this.Map_xmax*this.blocksize_x,o*this.blocksize_y),this.wallList.addChild(i,1,"wall")}this.generateKey_Lock()},e.prototype.regenerateMap=function(t){this.wallList.removeAllChildren(),this.Map_xmax=4*t+6,this.Map_ymax=2*t+3,this.myMap=new p.Map_Graph(this.Map_xmax,this.Map_ymax);for(var e=0;e<this.Map_xmax;e++)for(var o=0;o<this.Map_ymax;o++)this.myMap.mapBlock[o][e].up&&((n=cc.instantiate(this.horizontalWallPrefab)).setPosition(e*this.blocksize_x,o*this.blocksize_y),this.wallList.addChild(n,1,"wall")),this.myMap.mapBlock[o][e].left&&((n=cc.instantiate(this.verticalWallPrefab)).setPosition(e*this.blocksize_x,o*this.blocksize_y),this.wallList.addChild(n,1,"wall"));for(var i=0;i<this.Map_xmax;i++)(n=cc.instantiate(this.horizontalWallPrefab)).setPosition(i*this.blocksize_x,this.Map_ymax*this.blocksize_y),this.wallList.addChild(n,1,"wall");for(i=0;i<this.Map_ymax;i++){var n;(n=cc.instantiate(this.verticalWallPrefab)).setPosition(this.Map_xmax*this.blocksize_x,i*this.blocksize_y),this.wallList.addChild(n,1,"wall")}this.generateKey_Lock()},e.prototype.generateKey_Lock=function(){var t=0,e=0;t=Math.floor(Math.random()*this.Map_xmax)+.5,e=Math.floor(Math.random()*this.Map_ymax)+.5;var o=cc.instantiate(this.keyToNextLevel);o.setPosition(t*this.blocksize_x,e*this.blocksize_y),this.wallList.addChild(o,1,"key"),console.log("Key at:",t,e),t=Math.floor(Math.random()*this.Map_xmax)+.5,e=Math.floor(Math.random()*this.Map_ymax)+.5;var i=cc.instantiate(this.lockToNextLevel);i.setPosition(t*this.blocksize_x,e*this.blocksize_y),this.wallList.addChild(i,1,"lock"),console.log("Lock at:",t,e)},a([s(cc.Node)],e.prototype,"wallList",void 0),a([s(cc.Prefab)],e.prototype,"verticalWallPrefab",void 0),a([s(cc.Prefab)],e.prototype,"horizontalWallPrefab",void 0),a([s(cc.Prefab)],e.prototype,"keyToNextLevel",void 0),a([s(cc.Prefab)],e.prototype,"lockToNextLevel",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./MapGeneratorCore":"MapGeneratorCore"}],MapManager:[function(t,e,o){"use strict";cc._RF.push(e,"f3634jeIXpK057N1J8pdaI+","MapManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./utilities/ZSortOnLoad"),c=cc._decorator,s=c.ccclass,p=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.objectLayerNode=null,e.actorLayerNode=null,e}var o;return n(e,t),o=e,Object.defineProperty(e,"Instance",{get:function(){return o.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){cc.director.getPhysicsManager().enabled=!0,o.instance=this,this.objectLayerNode.addComponent(r.default)},e.prototype.start=function(){for(var t=[],e=0,o=this.actorLayerNode.children;e<o.length;e++){var i=o[e];t.push(i)}for(var n=0,a=t;n<a.length;n++){var r=(i=a[n]).convertToWorldSpaceAR(cc.Vec2.ZERO);i.setParent(this.objectLayerNode),i.setPosition(i.parent.convertToNodeSpaceAR(r))}},e.instance=null,a([p(cc.Node)],e.prototype,"objectLayerNode",void 0),a([p(cc.Node)],e.prototype,"actorLayerNode",void 0),o=a([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./utilities/ZSortOnLoad":"ZSortOnLoad"}],MenuMgr:[function(t,e,o){"use strict";cc._RF.push(e,"cfc9apDJ+1PsaY2ZhPv7xhx","MenuMgr");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../AuthManager"),c=cc._decorator,s=c.ccclass,p=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.VolumnValue=.5,e.isSigningUp=!1,e.authComp=null,e.startGameButton=null,e}return n(e,t),e.prototype.onLoad=function(){var t=new cc.Component.EventHandler;t.target=this.node,t.component="MenuMgr",t.handler="ShowSetting",cc.find("Canvas/background/OptionButton").getComponent(cc.Button).clickEvents.push(t)},e.prototype.ShowSetting=function(){var t=this;cc.resources.load("prefabs/Setting",cc.Prefab,function(e,o){if(e)cc.error("Failed to load Setting prefab: ",e);else{var i=cc.instantiate(o);i.setPosition(0,0),i.scaleX=2,i.scaleY=2,cc.find("Canvas").addChild(i),i.name="Setting",t.initSettingButton()}})},e.prototype.initSettingButton=function(){var t=new cc.Component.EventHandler;t.target=this.node,t.component="MenuMgr",t.handler="ExitSetting",cc.find("Canvas/Setting/ExitSetting").getComponent(cc.Button).clickEvents.push(t);var e=new cc.Component.EventHandler;e.target=this.node,e.component="MenuMgr",e.handler="SignUp",cc.find("Canvas/Setting/SignUp").getComponent(cc.Button).clickEvents.push(e);var o=new cc.Component.EventHandler;o.target=this.node,o.component="MenuMgr",o.handler="Login",cc.find("Canvas/Setting/Login").getComponent(cc.Button).clickEvents.push(o);var i=cc.find("Canvas/Setting/Volumn/VolumnSlider").getComponent(cc.Slider),n=cc.sys.localStorage.getItem("VolumnValue");i.progress=null!==n?Number(n):.5,i.node.on("slide",this.onVolumnChange,this)},e.prototype.ExitSetting=function(){var t=cc.find("Canvas/Setting");t&&t.destroy()},e.prototype.onVolumnChange=function(t){cc.audioEngine.setMusicVolume(t.progress),cc.audioEngine.setEffectsVolume(t.progress),this.VolumnValue=t.progress,cc.sys.localStorage.setItem("VolumnValue",this.VolumnValue.toString())},e.prototype.SignUp=function(){this.isSigningUp=!0,this.openSignupLoginPanel()},e.prototype.Login=function(){this.isSigningUp=!1,this.openSignupLoginPanel()},e.prototype.openSignupLoginPanel=function(){var t=this;cc.resources.load("prefabs/SignupLogin",cc.Prefab,function(e,o){if(e)cc.error("Failed to load SignupLogin prefab:",e);else{var i=o,n=cc.instantiate(i);n.setPosition(0,0),n.scaleX=.5,n.scaleY=.5,n.zIndex=1e3,cc.find("Canvas/Setting").addChild(n),n.name="SignupLogin",t.authComp=n.getComponent(r.default),t.authComp?t.initSignupLogin():cc.error("AuthManager component not found on SignupLogin prefab!")}})},e.prototype.initSignupLogin=function(){var t=new cc.Component.EventHandler;t.target=this.node,t.component="MenuMgr",t.handler="ExitSignupLogin",cc.find("Canvas/Setting/SignupLogin/Exit").getComponent(cc.Button).clickEvents.push(t);var e=new cc.Component.EventHandler;e.target=this.authComp.node,e.component="AuthManager",e.handler=this.isSigningUp?"SignUp":"Login",cc.find("Canvas/Setting/SignupLogin/Save").getComponent(cc.Button).clickEvents.push(e)},e.prototype.ExitSignupLogin=function(){var t=cc.find("Canvas/Setting/SignupLogin");t&&t.destroy()},e.prototype.enableStartButton=function(){this.startGameButton&&(this.startGameButton.node.active=!0)},a([p(cc.Button)],e.prototype,"startGameButton",void 0),a([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../AuthManager":"AuthManager"}],Menu:[function(t,e,o){"use strict";cc._RF.push(e,"4999co+59BDVK7wwshiNS5K","Menu");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ExitButton=null,e.Menubgm=null,e.VolumnValue=.5,e}return n(e,t),e.prototype.onLoad=function(){var t=cc.sys.localStorage.getItem("VolumnValue");this.VolumnValue=null!==t?Number(t):.5,this.playbgm(),cc.audioEngine.setMusicVolume(this.VolumnValue),cc.audioEngine.setEffectsVolume(this.VolumnValue),cc.sys.localStorage.setItem("VolumnValue",this.VolumnValue.toString());var e=new cc.Component.EventHandler;e.target=this.node,e.component="Menu",e.handler="ExitButtonEvent",this.ExitButton.clickEvents.push(e)},e.prototype.start=function(){var t=new cc.Component.EventHandler;t.target=this.node,t.component="Menu",t.handler="LoadGame",cc.find("Canvas/background/StartButton").getComponent(cc.Button).clickEvents.push(t);var e=new cc.Component.EventHandler;e.target=this.node,e.component="Menu",e.handler="LoadMap",cc.find("Canvas/background/MapButton").getComponent(cc.Button).clickEvents.push(e)},e.prototype.LoadGame=function(){cc.director.loadScene("Loading",function(){cc.find("Canvas/LoadingManager").getComponent("LoadingManager").startLoading("demo")})},e.prototype.LoadMap=function(){cc.director.loadScene("Loading",function(){cc.find("Canvas/LoadingManager").getComponent("LoadingManager").startLoading("demo_test")})},e.prototype.ExitButtonEvent=function(){cc.game.end()},e.prototype.playbgm=function(){this.Menubgm?cc.audioEngine.playMusic(this.Menubgm,!0):cc.error("BGM not assigned!")},a([s(cc.Button)],e.prototype,"ExitButton",void 0),a([s(cc.AudioClip)],e.prototype,"Menubgm",void 0),a([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],MonsterManager:[function(t,e,o){"use strict";cc._RF.push(e,"6c8acFpplVH1LwjnyqGOWFp","MonsterManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,c=cc._decorator,s=c.ccclass;c.property,function(t){t[t.BlueSlime=0]="BlueSlime",t[t.GreenSlime=1]="GreenSlime",t[t.GreenBoss=2]="GreenBoss",t[t.LavaSlime=3]="LavaSlime"}(r||(r={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.level=1,e.monsterManager=null,e.Map_xmax=0,e.Map_ymax=0,e}return n(e,t),e.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0,cc.director.getPhysicsManager().enabled=!0,this.level=cc.find("GameManager").getComponent("GameManager").Level,this.monsterManager=cc.find("Canvas/MapManager/MonsterManager"),console.log("Monster onload")},e.prototype.start=function(){},e.prototype.initMonster=function(){console.log("Map_xmax =",this.Map_xmax,"Map_ymax =",this.Map_ymax);var t=Math.floor(this.Map_xmax/100*(this.Map_ymax/100)/9);console.log("monster COunt = ",t);for(var e=0;e<t;e++){var o=Math.floor(3.9999*Math.random());switch(console.log("Monster Type:",o),o){case r.BlueSlime:this.initBlueSlime();break;case r.GreenSlime:this.initGreenSlime();break;case r.GreenBoss:this.initGreenBoss();break;case r.LavaSlime:this.initLavaSlime();break;default:cc.error("Unknown monster type:",o)}}},e.prototype.initBlueSlime=function(){var t=this;cc.resources.load("prefabs/Blue Slime",cc.Prefab,function(e,o){if(e)cc.error("Failed to load Blue Slime:",e);else{var i=cc.instantiate(o);t.monsterManager.addChild(i,1,"Blue Slime");var n=Math.floor(Math.random()*(t.Map_xmax+1)),a=Math.floor(Math.random()*(t.Map_ymax+1));i.setPosition(n,a)}}),console.log("Map_xmax =",this.Map_xmax,"Map_ymax =",this.Map_ymax)},e.prototype.initGreenSlime=function(){var t=this;cc.resources.load("prefabs/Green Slime",cc.Prefab,function(e,o){if(e)cc.error("Failed to load Green Slime:",e);else{var i=cc.instantiate(o);t.monsterManager.addChild(i,1,"Green Slime");var n=Math.floor(Math.random()*(t.Map_xmax+1)),a=Math.floor(Math.random()*(t.Map_ymax+1));i.setPosition(n,a),console.log("x=",n,"y=",a)}})},e.prototype.initGreenBoss=function(){var t=this;cc.resources.load("prefabs/Green Boss",cc.Prefab,function(e,o){if(e)cc.error("Failed to load Green Boss",e);else{var i=cc.instantiate(o);t.monsterManager.addChild(i,1,"Green Boss");var n=Math.floor(Math.random()*(t.Map_xmax+1)),a=Math.floor(Math.random()*(t.Map_ymax+1));i.setPosition(n,a)}}),console.log("Map_xmax =",this.Map_xmax,"Map_ymax =",this.Map_ymax)},e.prototype.initLavaSlime=function(){var t=this;cc.resources.load("prefabs/Lava Slime",cc.Prefab,function(e,o){if(e)cc.error("Failed to load Lava Slime:",e);else{var i=cc.instantiate(o);t.monsterManager.addChild(i,1,"Lava Slime");var n=Math.floor(Math.random()*(t.Map_xmax+1)),a=Math.floor(Math.random()*(t.Map_ymax+1));i.setPosition(n,a)}}),console.log("Map_xmax =",this.Map_xmax,"Map_ymax =",this.Map_ymax)},e.prototype.SetMonster=function(t){this.level=t,cc.find("GameManager").getComponent("GameManager"),this.Map_xmax=Number(100*(4*this.level+6)),this.Map_ymax=Number(100*(2*this.level+3)),console.log("Level = ",this.level,typeof this.level),console.log("Map_xmax = ",this.Map_xmax,typeof this.Map_xmax),this.monsterManager.removeAllChildren(),this.initMonster(),console.log("set monster")},a([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],Player:[function(t,e,o){"use strict";cc._RF.push(e,"332a6gSxQ5LRb25rr5dLCw6","Player");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=t("./GameManager"),l=t("./ai/BlueSlimeAI"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxHp=40,e.attackPower=5,e.hp=40,e.lifebar=null,e.controller=null,e.attack1sound=null,e.attack2sound=null,e.attack3sound=null,e.hurtsound=null,e.healsound=null,e.gameManager=null,e.holdingKey=!1,e.attackRange=50,e.attackHitDelay=.2,e.attackAnimDuration=.5,e.isAttacking=!1,e.facing="down",e.isDead=!1,e}return n(e,t),e.prototype.onLoad=function(){this.anim=this.getComponent(cc.Animation),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onDestroy=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},e.prototype.onKeyDown=function(t){t.keyCode!==cc.macro.KEY.c&&t.keyCode!==cc.macro.KEY.z&&t.keyCode!==cc.macro.KEY.v||this.tryAttack()},e.prototype.tryAttack=function(){var t=this;this.isAttacking||(this.isAttacking=!0,this.anim&&this.anim.play("PlayerAttack"),this.attack1sound&&cc.audioEngine.playEffect(this.attack1sound,!1),this.scheduleOnce(this.applyAttackHit,this.attackHitDelay),this.scheduleOnce(function(){t.isAttacking=!1},this.attackAnimDuration))},e.prototype.applyAttackHit=function(){var t=this,e=this.node.convertToWorldSpaceAR(cc.v3(0,0,0)),o=cc.v2(e.x,e.y),i=cc.find("Canvas/MapManager/MonsterManager");i&&i.children.forEach(function(e){var i=e.getComponent(l.default);if(i){var n=e.convertToWorldSpaceAR(cc.v3(0,0,0)),a=cc.v2(n.x,n.y);o.sub(a).mag()<=t.attackRange&&i.takeDamage(t.attackPower)}})},Object.defineProperty(e.prototype,"worldPosition",{get:function(){return this.node.convertToWorldSpaceAR(cc.v3(0,0,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localPosition",{get:function(){return this.node.position},enumerable:!1,configurable:!0}),e.prototype.takeDamage=function(t){var e=this;if(this.hp-=t,this.hp<0&&(this.hp=0),this.hp>0){switch(this.facing){case"up":this.anim.play("hurt_up");break;case"down":this.anim.play("hurt_down");break;case"left":this.anim.play("hurt_left");break;case"right":this.anim.play("hurt_right");break;default:this.anim.play("hurt_"+this.facing)}return this.updatelife(-t,this.hp),void(this.hurtsound&&cc.audioEngine.playEffect(this.hurtsound,!1))}switch(this.facing){case"up":this.anim.play("death_up");break;case"down":this.anim.play("death_down");break;case"left":this.anim.play("death_left");break;case"right":this.anim.play("death_right");break;default:this.anim.play("death_"+this.facing)}this.updatelife(-t,this.hp),this.isDead=!0,this.scheduleOnce(function(){e.die()},1)},e.prototype.heal=function(t){this.hp+=t,this.hp>this.maxHp&&(this.hp=this.maxHp),this.updatelife(t,this.hp),this.playhealsound()},e.prototype.attack=function(t){t.takeDamage(this.attackPower)},e.prototype.die=function(){this.controller.getComponent("ActorController").godie(),this.unscheduleAllCallbacks()},e.prototype.updatelife=function(t,e){this.lifebar.width=e,this.lifebar.color=e<=10?cc.Color.RED:e<=20?cc.Color.ORANGE:cc.Color.GREEN},e.prototype.playattack1sound=function(){this.attack1sound?cc.audioEngine.playEffect(this.attack1sound,!1):console.log("No attack1 sound")},e.prototype.playattack2sound=function(){this.attack2sound?cc.audioEngine.playEffect(this.attack2sound,!1):console.log("No attack2 sound")},e.prototype.playattack3sound=function(){this.attack3sound?cc.audioEngine.playEffect(this.attack3sound,!1):console.log("No attack3 sound")},e.prototype.playhurtsound=function(){this.hurtsound?cc.audioEngine.playEffect(this.hurtsound,!1):console.log("No hurtsound")},e.prototype.playhealsound=function(){this.healsound?cc.audioEngine.playEffect(this.healsound,!1):console.log("No healsound")},e.prototype.SetPlayer=function(){this.hp=this.maxHp,this.updatelife(0,this.hp),this.node.setPosition(20,20),this.holdingKey=!1},e.prototype.onBeginContact=function(t,e,o){var i=this;if("key"==o.node.name&&(this.holdingKey=!0,o.node.active=!1),"lock"==o.node.name){var n=o.getComponent("NewClass");n&&n.playAnim(),this.scheduleOnce(function(){o.node.destroy(),i.gameManager.GoNextLevel()},1.2)}},e.prototype.onDisable=function(){this.unscheduleAllCallbacks()},a([s({type:cc.Integer,tooltip:"\u6700\u5927\u8840\u91cf"})],e.prototype,"maxHp",void 0),a([s({type:cc.Integer,tooltip:"\u653b\u64ca\u529b"})],e.prototype,"attackPower",void 0),a([s({type:cc.Integer,tooltip:"\u521d\u59cb\u8840\u91cf"})],e.prototype,"hp",void 0),a([s(cc.Node)],e.prototype,"lifebar",void 0),a([s(cc.Node)],e.prototype,"controller",void 0),a([s(cc.AudioClip)],e.prototype,"attack1sound",void 0),a([s(cc.AudioClip)],e.prototype,"attack2sound",void 0),a([s(cc.AudioClip)],e.prototype,"attack3sound",void 0),a([s(cc.AudioClip)],e.prototype,"hurtsound",void 0),a([s(cc.AudioClip)],e.prototype,"healsound",void 0),a([s(p.default)],e.prototype,"gameManager",void 0),a([s({type:cc.Integer,tooltip:"Player attack range in pixels"})],e.prototype,"attackRange",void 0),a([s({type:cc.Float,tooltip:"When (sec) to check hit in attack anim"})],e.prototype,"attackHitDelay",void 0),a([s({type:cc.Float,tooltip:"Length of PlayerAttack animation"})],e.prototype,"attackAnimDuration",void 0),a([c],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./GameManager":"GameManager","./ai/BlueSlimeAI":"BlueSlimeAI"}],Potion:[function(t,e,o){"use strict";cc._RF.push(e,"99797thkEZDgY+hxJ3aSYzY","Potion");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.healAmount=10,e}return n(e,t),e.prototype.onLoad=function(){var t=this.getComponent(cc.Animation);console.log("pot"),t?t.play("pot_out"):console.log("pot no show"),this.scheduleOnce(function(){t&&t.play("pot_idle")},.5)},e.prototype.onPickup=function(){var t=cc.find("Canvas/MapManager/Actors/Player");console.log("pickup"),t&&t.getComponent("Player").heal(this.healAmount),this.node.destroy()},e.prototype.onCollisionEnter=function(t){"Player"===t.node.name&&this.onPickup()},a([s({type:cc.Integer})],e.prototype,"healAmount",void 0),a([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],ShyAgent:[function(t,e,o){"use strict";cc._RF.push(e,"0b710El2DRDKqoljmM7gWCo","ShyAgent");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../input/IInputControls"),c=t("./Agent"),s=t("./strategies/Coward"),p=t("./strategies/Wanderer"),l=cc._decorator,h=l.ccclass,u=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moveDuration=1,e.moveSpeed=1,e.waitDuration=.5,e.waitRandomFactor=.1,e.runAwayFrom=null,e.safeDistance=5,e.attack=r.ButtonState.Rest,e.interact=r.ButtonState.Rest,e._moveAxis2D=cc.Vec2.ZERO,e._wanderer=null,e._coward=null,e._isWaiting=!1,e}return n(e,t),Object.defineProperty(e.prototype,"horizontalAxis",{get:function(){return this._moveAxis2D.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAxis",{get:function(){return this._moveAxis2D.y},enumerable:!1,configurable:!0}),e.prototype.agentUpdate=function(t){if(this._wanderer&&this._coward){this._wanderer.update(t),this._coward.update(t);var e,o=cc.v2(this._wanderer.horizontalAxis,this._wanderer.verticalAxis),i=cc.v2(this._coward.horizontalAxis,this._coward.verticalAxis);o.fuzzyEquals(cc.Vec2.ZERO,.01)?(this._isWaiting=!0,this._moveAxis2D=o):this._isWaiting&&(this._coward.distanceFromTarget<this.safeDistance?this._moveAxis2D=(e=i,.25,o.mul(.25).add(e.mul(.75))):this._moveAxis2D=o,this._isWaiting=!1)}},e.prototype.onLoad=function(){this._wanderer=new p.Wanderer(this.moveDuration,this.waitDuration,this.waitRandomFactor),this._coward=new s.Coward(this,this.runAwayFrom)},e.prototype.start=function(){this._wanderer.start(),this._coward.start()},a([u(cc.Float)],e.prototype,"moveDuration",void 0),a([u(cc.Float)],e.prototype,"moveSpeed",void 0),a([u(cc.Float)],e.prototype,"waitDuration",void 0),a([u(cc.Float)],e.prototype,"waitRandomFactor",void 0),a([u(cc.Node)],e.prototype,"runAwayFrom",void 0),a([u(cc.Float)],e.prototype,"safeDistance",void 0),a([h],e)}(c.default);o.default=d,cc._RF.pop()},{"../input/IInputControls":"IInputControls","./Agent":"Agent","./strategies/Coward":"Coward","./strategies/Wanderer":"Wanderer"}],SuccessPopup:[function(t,e,o){"use strict";cc._RF.push(e,"f3764DDp7JFh4sQoYTrrh15","SuccessPopup");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.messageLabel=null,e.onOk=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this;cc.find("DialogBox/OKButton",this.node).getComponent(cc.Button).node.on("click",function(){t.onOk&&t.onOk(),t.node.destroy()})},a([s(cc.Label)],e.prototype,"messageLabel",void 0),a([c("SuccessPopup")],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],UIManager:[function(t,e,o){"use strict";cc._RF.push(e,"22a1002ZNBB7bNqwt8XPmZL","UIManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0,cc.director.getPhysicsManager().enabled=!0},e.prototype.start=function(){},a([c],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],WanderAgent:[function(t,e,o){"use strict";cc._RF.push(e,"2a05fAQ2UJPQIurJewep8gS","WanderAgent");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../input/IInputControls"),c=t("./Agent"),s=t("./strategies/Wanderer"),p=cc._decorator,l=p.ccclass,h=p.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moveDuration=1,e.moveSpeed=5,e.waitDuration=.5,e.waitRandomFactor=.1,e._strategy=null,e.attack=r.ButtonState.Rest,e.interact=r.ButtonState.Rest,e}return n(e,t),Object.defineProperty(e.prototype,"horizontalAxis",{get:function(){return this._strategy?this._strategy.horizontalAxis*this.moveSpeed:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAxis",{get:function(){return this._strategy?this._strategy.verticalAxis*this.moveSpeed:0},enumerable:!1,configurable:!0}),e.prototype.agentUpdate=function(t){this._strategy.update(t)},e.prototype.onLoad=function(){this._strategy=new s.Wanderer(this.moveDuration,this.waitDuration,this.waitRandomFactor)},e.prototype.start=function(){this._strategy.start()},a([h(cc.Float)],e.prototype,"moveDuration",void 0),a([h(cc.Float)],e.prototype,"moveSpeed",void 0),a([h(cc.Float)],e.prototype,"waitDuration",void 0),a([h(cc.Float)],e.prototype,"waitRandomFactor",void 0),a([l],e)}(c.default);o.default=u,cc._RF.pop()},{"../input/IInputControls":"IInputControls","./Agent":"Agent","./strategies/Wanderer":"Wanderer"}],Wanderer:[function(t,e,o){"use strict";cc._RF.push(e,"1f7aasmeZhNIoYFA83XzaqQ","Wanderer");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.Wanderer=void 0;var a=function(t){function e(e,o,i){var n=t.call(this)||this;return n._moveDuration=1,n._waitDuration=.5,n._waitRandomFactor=.1,n._nextWaitTime=0,n._nextMoveTime=0,n._wanderVelocity=cc.Vec2.ZERO,n._moveAxis2D=cc.Vec2.ZERO,n._moveDuration=e,n._waitDuration=o,n._waitRandomFactor=i,n}return n(e,t),Object.defineProperty(e.prototype,"horizontalAxis",{get:function(){return this._moveAxis2D.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticalAxis",{get:function(){return this._moveAxis2D.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attack",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"interact",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._nextMoveTime=cc.director.getTotalTime()/1e3,this._nextWaitTime=this._nextMoveTime-this._waitDuration},e.prototype.update=function(){var t,e=cc.director.getTotalTime()/1e3;e>=this._nextMoveTime&&(this._nextWaitTime=e+this._moveDuration,this._nextMoveTime=this._nextWaitTime+1*this._waitDuration*this._waitRandomFactor*(Math.random()-2),this._wanderVelocity=(t=Math.random()*Math.PI*2,new cc.Vec2(Math.cos(t),Math.sin(t)))),this._moveAxis2D=e<this._nextWaitTime?this._wanderVelocity:cc.Vec2.ZERO},e}(t("./AgentStrategy").AI.Strategy);o.Wanderer=a,cc._RF.pop()},{"./AgentStrategy":"AgentStrategy"}],Waypoint:[function(t,e,o){"use strict";cc._RF.push(e,"c1fb9eQwYFFiaL2Pab25I/w","Waypoint");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.adjacentWaypoints=[],e.distances=[],e}var o;return n(e,t),o=e,e.prototype.distanceTo=function(t){return this.distanceToNode(t.node)},e.prototype.distanceToNode=function(t){return t.convertToWorldSpaceAR(cc.Vec2.ZERO).sub(this.node.convertToWorldSpaceAR(cc.Vec2.ZERO)).mag()},e.prototype.addEdgeTo=function(t){this.adjacentWaypoints.push(t),this.distances.push(this.distanceTo(t))},e.prototype.onLoad=function(){for(var t=0,e=this.adjacentWaypoints;t<e.length;t++){var o=e[t];this.distances.push(this.distanceTo(o))}},e.prototype.start=function(){},a([s(o)],e.prototype,"adjacentWaypoints",void 0),a([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],ZSortOnLoad:[function(t,e,o){"use strict";cc._RF.push(e,"1855dXZEzdGf7iIoaoAeRs6","ZSortOnLoad");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){for(var t=0,e=this.node.children;t<e.length;t++){var o=e[t];o.zIndex=1e4-o.y}},a([c],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],ZSorter:[function(t,e,o){"use strict";cc._RF.push(e,"99e25O3dctP9r6blHhMnMae","ZSorter");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.update=function(){this.node.zIndex=1e4-this.node.y},a([c],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],chest:[function(t,e,o){"use strict";cc._RF.push(e,"cb56d6Gb/dNLqqqC/gApn0D","chest");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.potionPrefab=null,e.openSound=null,e._animation=null,e._isOpened=!1,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.onCollisionEnter=function(t){this._isOpened||"Player"===t.node.name&&(this.openChest(),this._isOpened=!0)},e.prototype.openChest=function(){var t=this.getComponent(cc.Animation);t&&t.play("chest_open"),this.scheduleOnce(function(){},.5);var e=cc.instantiate(this.potionPrefab);e.parent=this.node,e.setPosition(this.node.position)},a([s(cc.Prefab)],e.prototype,"potionPrefab",void 0),a([s(cc.AudioClip)],e.prototype,"openSound",void 0),a([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{}]},{},["ActorController","AuthManager","FirebaseInit","GameManager","MapGenerator","MapGeneratorCore","MapManager","LoadingManager","Menu","MenuMgr","MonsterManager","Player","SuccessPopup","UIManager","Agent","BlueSlimeAI","GreenBossAI","GreenSlimeAI","LavaSlimeAI","ShyAgent","WanderAgent","Waypoint","AgentStrategy","Coward","Wanderer","CameraTransposer","Controller","IInputControls","KeyboardControls","Key","Lock","Potion","chest","ZSortOnLoad","ZSorter"]);