{"version":3,"sources":["assets/scripts/ActorController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\n\nimport Controller from \"./input/Controller\";\nimport { IInputControls, ButtonState } from \"./input/IInputControls\";\nimport  Player    from \"./player\";\n\nconst { ccclass, property } = cc._decorator;\nenum PlayerState{\n    Idle,\n    Walk,\n    Attack,\n    Attack2,\n    Attack3,\n    Hurt,\n    Die ,\n    Combo_1\n}\n\nenum FacingDirection {\n    Right,\n    Left,\n    Up,\n    Down\n}\n\nfunction sign(x: number) {\n    return x > 0 ? 1 : x < 0 ? -1 : 0;\n}\n\n/**\n * A component that implements movement and actions for each actor.\n * Toggle \"Use Player Input\" to read from player input.\n */\n@ccclass\nexport default class ActorController extends Controller {\n    @property({ type: cc.Enum(FacingDirection) })\n    initialFacingDirection = FacingDirection.Right;\n\n    @property(cc.Node)\n    player: cc.Node = null;\n    \n\n    private _animation: cc.Animation = null;\n    private _animState: cc.AnimationState = null;\n    private _rigidbody: cc.RigidBody = null;\n\n    @property(cc.String)\n    idleAnimationName: string = \"\";\n\n    @property(cc.String)\n    moveAnimationName: string = \"\";\n\n    private _idleAnimState: cc.AnimationState = null;\n    private _moveAnimState: cc.AnimationState = null;\n    @property(cc.String)\n    walkRightAnimation: string = \"player_walk_right\";\n    @property(cc.String)\n    walkLeftAnimation: string = \"player_walk_left\";\n    @property(cc.String)\n    walkUpAnimation: string = \"player_walk_up\";\n    @property(cc.String)\n    walkDownAnimation: string = \"player_walk_down\";\n\n    @property(cc.String)\n    idleAnimation: string = \"player_standby\"; \n\n    @property(cc.String)\n    attack_right: string = \"attack_right-1\";\n    @property(cc.String)\n    attack_left: string = \"attack_left-1\";\n    @property(cc.String)\n    attack_up: string = \"attack_up-1\";\n    @property(cc.String)\n    attack_down: string = \"attack_down-1\";\n\n    @property(cc.String)\n    attack_right_2: string = \"attack_right-2\";\n    @property(cc.String)\n    attack_left_2: string = \"attack_left-2\";\n    @property(cc.String)\n    attack_up_2: string = \"attack_up-2\";\n    @property(cc.String)\n    attack_down_2: string = \"attack_down-2\";\n\n    @property(cc.String)\n    attack_right_3: string = \"attack_right-3\";\n    @property(cc.String)\n    attack_left_3: string = \"attack_left-3\";\n    @property(cc.String)\n    attack_up_3: string = \"attack_up-3\";\n    @property(cc.String)\n    attack_down_3: string = \"attack_down-3\";\n\n    @property(cc.String)\n    death_right: string = \"death_right\";\n    @property(cc.String)\n    death_left: string = \"death_left\";\n    @property(cc.String)\n    death_up: string = \"death_up\";\n    @property(cc.String)\n    death_down: string = \"death_down\";\n\n    @property(cc.String)\n    hurt_right: string = \"hurt_right\";\n    @property(cc.String)\n    hurt_left: string = \"hurt_left\";\n    @property(cc.String)\n    hurt_up: string = \"hurt_up\";\n    @property(cc.String)\n    hurt_down: string = \"hurt_down\";\n\n    @property(cc.String)\n    combo_right_1: string = \"combo-1_right\";\n    @property(cc.String)\n    combo_left_1: string = \"combo-1_left\";\n    @property(cc.String)\n    combo_up_1: string = \"combo-1_up\";\n    @property(cc.String)\n    combo_down_1: string = \"combo-1_down\";\n\n    @property(cc.Float)\n    moveSpeed = 20; \n\n    public moveAxisX = 0;\n    public moveAxisY = 0;\n\n    private _playerState: PlayerState = PlayerState.Idle;\n    private _facing: FacingDirection = FacingDirection.Down; // 預設朝下\n    private _lastAnim: string = \"\";\n\n    private combostep: number = 0;\n    private combotimer: number = 0;\n\n    @property(cc.Float)\n    comboInterval: number = 1;\n\n    public get moveAxis2D() {\n        return new cc.Vec2(this.moveAxisX, this.moveAxisY);\n    }\n\n    onLoad() {\n        this._animation = this.node.getComponent(cc.Animation);\n        if (!this._animation) console.warn(`ActorController: Component cc.Animation missing on node ${this.node.name}`);\n\n        this._rigidbody = this.node.getComponent(cc.RigidBody);\n        if (!this._rigidbody) console.warn(`ActorController: Component cc.RigidBody missing on node ${this.node.name}`);\n    }\n\n    start() {\n        super.start && super.start();\n        if (this._animation) {\n            this._idleAnimState = this._animation.getAnimationState(this.idleAnimationName);\n            this._moveAnimState = this._animation.getAnimationState(this.moveAnimationName);\n            this._animState = this._animation.play(this.idleAnimationName);\n            this._animation.on('finished', this.onAnimFinished, this);\n        }\n    }\n    update(dt) {\n        if (this._playerState === PlayerState.Die) return;\n        if (this.combostep > 0){\n            this.combotimer += dt;\n            if (this.combotimer >= this.comboInterval) {\n                this.combostep = 0;\n            }\n        }\n\n        if (this.inputSource ) {\n                if(this.incombo()) return;\n                this.moveAxisX = this.inputSource.horizontalAxis;\n                this.moveAxisY = this.inputSource.verticalAxis;\n    \n                let velocity = this.moveAxis2D.mul(this.moveSpeed);\n                if (this._rigidbody) {\n                    this._rigidbody.linearVelocity = velocity;\n                }\n\n                let is_playing= (this._animation.getAnimationState(this._lastAnim) && this._animation.getAnimationState(this._lastAnim).isPlaying)\n\n                // 狀態機：移動 or 靜止\n                if (this.moveAxisX !== 0 || this.moveAxisY !== 0) {\n                    this._playerState = PlayerState.Walk;\n                    // 根據輸入更新朝向\n                    if (Math.abs(this.moveAxisX) > Math.abs(this.moveAxisY)) {\n                        this._facing = this.moveAxisX > 0 ? FacingDirection.Right : FacingDirection.Left;\n                    } else {\n                        this._facing = this.moveAxisY > 0 ? FacingDirection.Up : FacingDirection.Down;\n                    }\n                } else if (!is_playing){\n                    this._playerState = PlayerState.Idle;\n                } else if(this.iswalking()){\n                    this._playerState = PlayerState.Idle;\n                }\n    \n                // 這裡可以根據按鍵觸發攻擊等狀態\n                if(!is_playing || !this.incombo()){\n                    if (this.inputSource.attack===ButtonState.Pressed) { \n                        this._playerState = PlayerState.Attack; \n                        this.player.getComponent(\"Player\").playattack1sound();\n                    }else if(this.inputSource.attack2===ButtonState.Pressed){\n                        this._playerState = PlayerState.Attack2;\n                        this.player.getComponent(\"Player\").playattack2sound();\n                    }else if(this.inputSource.attack3===ButtonState.Pressed){\n                        this._playerState = PlayerState.Attack3;\n                        this.player.getComponent(\"Player\").playattack3sound();\n                    } else if (this.inputSource.gethurt===ButtonState.Pressed) { \n                        this._playerState = PlayerState.Hurt; \n                        this.player.getComponent(\"Player\").takeDamage(5);\n                        this.inputSource._xKey = ButtonState.Held;\n                    }\n                    this.incombo();\n                }\n                // 狀態+方向決定動畫\n                let animName = this.getAnimName(this._playerState, this._facing);\n                //如果是combo 狀態 播放動畫直到 combo 結束\n                if (this._animation && animName && animName !== this._lastAnim && !this.stopupdate()) {\n                    console.log(this._lastAnim,animName);\n                    this._animState = this._animation.play(animName);\n                    this._lastAnim = animName;\n                }\n                console.log(this._playerState,this._lastAnim  ,this.combostep, this.combotimer);\n\n            }    \n        }\n    \n        getAnimName(state: PlayerState, facing: FacingDirection): string {\n            switch (state) {\n                case PlayerState.Combo_1:\n                    switch (facing) {\n                        case FacingDirection.Right: return this.combo_right_1;\n                        case FacingDirection.Left:  return this.combo_left_1;\n                        case FacingDirection.Up:    return this.combo_up_1;\n                        case FacingDirection.Down:  return this.combo_down_1;\n                    }\n                    break;\n                case PlayerState.Walk:\n                    switch (facing) {\n                        case FacingDirection.Right: return this.walkRightAnimation;\n                        case FacingDirection.Left:  return this.walkLeftAnimation;\n                        case FacingDirection.Up:    return this.walkUpAnimation;\n                        case FacingDirection.Down:  return this.walkDownAnimation;\n                    }\n                    break;\n                case PlayerState.Idle:\n                    return this.idleAnimation;\n                case PlayerState.Attack:\n                    switch (facing) {\n                        case FacingDirection.Right: return this.attack_right;\n                        case FacingDirection.Left:  return this.attack_left;\n                        case FacingDirection.Up:    return this.attack_up;\n                        case FacingDirection.Down:  return this.attack_down;\n                        \n                    }\n                    break;\n                case PlayerState.Attack2:\n                    switch (facing) {\n                        case FacingDirection.Right: return this.attack_right_2;\n                        case FacingDirection.Left:  return this.attack_left_2;\n                        case FacingDirection.Up:    return this.attack_up_2;\n                        case FacingDirection.Down:  return this.attack_down_2;\n                        \n                    }\n                    break;\n                case PlayerState.Attack3:\n                    switch (facing) {\n                        case FacingDirection.Right: return this.attack_right_3;\n                        case FacingDirection.Left:  return this.attack_left_3;\n                        case FacingDirection.Up:    return this.attack_up_3;\n                        case FacingDirection.Down:  return this.attack_down_3;\n                        \n                    }\n                    break;\n                case PlayerState.Hurt:\n                    switch (facing) {\n                        case FacingDirection.Right: return this.hurt_right;\n                        case FacingDirection.Left:  return this.hurt_left;\n                        case FacingDirection.Up:    return this.hurt_up;\n                        case FacingDirection.Down:  return this.hurt_down;\n                    }\n                    break;\n                case PlayerState.Die:\n                    switch (facing) {\n                        case FacingDirection.Right: return this.death_right;\n                        case FacingDirection.Left:  return this.death_left;\n                        case FacingDirection.Up:    return this.death_up;\n                        case FacingDirection.Down:  return this.death_down;\n                    }\n                    break;\n            }\n            return \"\";\n        }\n    private onAnimFinished(){\n        console.log(\"finish\");\n        if (this._playerState === PlayerState.Attack ||\n            this._playerState === PlayerState.Attack2 ||\n            this._playerState === PlayerState.Attack3 ||\n            this._playerState === PlayerState.Hurt ||\n            this._playerState === PlayerState.Combo_1 \n        ) {\n            this._playerState = PlayerState.Idle;\n            this._lastAnim = \"\";\n        }\n    }\n    stopupdate() {\n        const animNames = [\n            this.combo_up_1,\n            this.combo_down_1,\n            this.combo_left_1,\n            this.combo_right_1\n        ];\n\n        for (const name of animNames) {\n            const state = this._animation.getAnimationState(name);\n            if (state && state.isPlaying) return true;\n        }\n        return false;\n    }\n    incombo(){\n        if (this._playerState === PlayerState.Combo_1) return true;\n        if (this._playerState ===PlayerState.Attack ) {\n            this.combostep = 1;\n            this.combotimer = 0;\n            return false;\n        }else if (this._playerState === PlayerState.Attack2 && this.combostep === 1 && this.combotimer < this.comboInterval){\n            this.combostep = 2;\n            this.combotimer = 0;\n            return false;\n        } else if(this._playerState === PlayerState.Attack3 && this.combostep === 2 && this.combotimer < this.comboInterval){\n            this.combostep = 3;\n            this.combotimer = 0;\n            this._playerState = PlayerState.Combo_1;\n            return true;\n        }\n        return false;\n    }\n    iswalking(){\n        const animNames = [\n            this.walkDownAnimation,this.walkLeftAnimation,this.walkRightAnimation,this.walkUpAnimation\n        ];\n        for (const name of animNames) {\n            const state = this._animation.getAnimationState(name);\n            if (state && state.isPlaying) return true;\n        }\n        return false;\n    }\n\n    public godie(){\n        this._playerState = PlayerState.Die;\n    }\n        \n}\n    \n\n"]}