{"version":3,"sources":["assets\\scripts\\Menu\\MenuMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport AuthManager from './AuthManager';\r\nconst {ccclass, property} = cc._decorator;\r\ndeclare const firebase: any;\r\n\r\nconst firebaseConfig = {\r\n    apiKey: \"AIzaSyDFW4-emWdI1ghgZWWGp1wqoWvAvTwAqrQ\",\r\n    authDomain: \"rune-raids.firebaseapp.com\",\r\n    projectId: \"rune-raids\",\r\n    storageBucket: \"rune-raids.firebasestorage.app\",\r\n    messagingSenderId: \"530514360843\",\r\n    appId: \"1:530514360843:web:1cdda9d72bb4b52932250e\",\r\n    measurementId: \"G-B1C5FG1YSN\"\r\n};\r\n\r\n\r\n@ccclass\r\nexport default class MenuMgr extends cc.Component {\r\n\r\n    public VolumnValue: number = 0.5;\r\n    public isSigningUp: boolean = false;\r\n    private authComp: AuthManager | null = null;\r\n    @property(cc.Button) startGameButton: cc.Button = null;\r\n\r\n    onLoad() {\r\n        // Hook up OptionButton → ShowSetting\r\n        let OptionButton = new cc.Component.EventHandler();\r\n        OptionButton.target = this.node;\r\n        OptionButton.component = \"MenuMgr\";\r\n        OptionButton.handler = \"ShowSetting\";\r\n        cc.find(\"Canvas/background/OptionButton\").getComponent(cc.Button).clickEvents.push(OptionButton);\r\n        cc.log(\"Is Firebase initialized?\", window._firebaseInited);\r\n\r\n\r\n        if (!window._firebaseInited) {\r\n            firebase.initializeApp(firebaseConfig);\r\n            window._firebaseInited = true;\r\n            cc.log(\"✅ Firebase initialized in MenuMgr\");\r\n        } else {\r\n            cc.log(\"ℹ️ Firebase already initialized\");\r\n        }\r\n        //Load VolumnValue from localStorage\r\n    }\r\n\r\n    ShowSetting() {\r\n        // Setting is a prefab\r\n        cc.resources.load(\"prefabs/Setting\", cc.Prefab, (err, prefab) => {\r\n            if (err) {\r\n                cc.error(\"Failed to load Setting prefab: \", err);\r\n                return;\r\n            }\r\n            const settingNode = cc.instantiate(prefab);\r\n            settingNode.setPosition(0, 0);\r\n            settingNode.scaleX = 2;\r\n            settingNode.scaleY = 2;\r\n            cc.find(\"Canvas\").addChild(settingNode);\r\n            settingNode.name = \"Setting\";\r\n    \r\n            this.initSettingButton();\r\n        })\r\n        \r\n    }\r\n    initSettingButton(){\r\n        //ExitSettingButton is a biutton in Setting prefab\r\n        let ExitSettingButton = new cc.Component.EventHandler();\r\n        ExitSettingButton.target = this.node;\r\n        ExitSettingButton.component = \"MenuMgr\";\r\n        ExitSettingButton.handler = \"ExitSetting\";\r\n        cc.find(\"Canvas/Setting/ExitSetting\").getComponent(cc.Button).clickEvents.push(ExitSettingButton);\r\n\r\n        //Sign up\r\n        let SignUpButton = new cc.Component.EventHandler();\r\n        SignUpButton.target = this.node;\r\n        SignUpButton.component = \"MenuMgr\";\r\n        SignUpButton.handler = \"SignUp\";\r\n        cc.find(\"Canvas/Setting/SignUp\").getComponent(cc.Button).clickEvents.push(SignUpButton);\r\n\r\n        //Login\r\n        let LoginButton = new cc.Component.EventHandler();\r\n        LoginButton.target = this.node;\r\n        LoginButton.component = \"MenuMgr\";\r\n        LoginButton.handler = \"Login\";\r\n        cc.find(\"Canvas/Setting/Login\").getComponent(cc.Button).clickEvents.push(LoginButton);\r\n\r\n        //Volumnslider\r\n        let Volumnslider = cc.find(\"Canvas/Setting/Volumn/VolumnSlider\").getComponent(cc.Slider);\r\n        let savedVolumn = cc.sys.localStorage.getItem(\"VolumnValue\");\r\n        if (savedVolumn !== null) Volumnslider.progress = Number(savedVolumn);\r\n        else Volumnslider.progress = 0.5;\r\n        Volumnslider.node.on('slide', this.onVolumnChange, this);\r\n    }\r\n\r\n    ExitSetting() {\r\n        let settingNode = cc.find(\"Canvas/Setting\");\r\n        if(settingNode) settingNode.destroy();\r\n    }\r\n\r\n    onVolumnChange(slider: cc.Slider){\r\n        cc.audioEngine.setMusicVolume(slider.progress); // 0~1\r\n        cc.audioEngine.setEffectsVolume(slider.progress);\r\n        this.VolumnValue = slider.progress;\r\n        cc.sys.localStorage.setItem(\"VolumnValue\", this.VolumnValue.toString());\r\n    }\r\n\r\n    SignUp(){\r\n        this.isSigningUp = true;\r\n        this.openSignupLoginPanel();\r\n    }\r\n\r\n    Login() {\r\n        this.isSigningUp = false;\r\n        this.openSignupLoginPanel();\r\n    }\r\n\r\n    private openSignupLoginPanel() {\r\n        cc.resources.load(\"prefabs/SignupLogin\", cc.Prefab, (err, asset) => {\r\n        if (err) {\r\n            cc.error(\"Failed to load SignupLogin prefab:\", err);\r\n            return;\r\n        }\r\n        // Cast the loaded asset to cc.Prefab:\r\n        const prefab = asset as cc.Prefab;\r\n\r\n        // Now instantiate a Node from that prefab\r\n        const signupLoginNode = cc.instantiate(prefab);\r\n        signupLoginNode.setPosition(0, 0);\r\n        signupLoginNode.scaleX = 0.5;\r\n        signupLoginNode.scaleY = 0.5;\r\n        signupLoginNode.zIndex = 1000;\r\n        cc.find(\"Canvas/Setting\").addChild(signupLoginNode);\r\n        signupLoginNode.name = \"SignupLogin\";\r\n\r\n        // grab the AuthManager component from the newly‐created Node\r\n        this.authComp = signupLoginNode.getComponent(AuthManager);\r\n        if (!this.authComp) {\r\n            cc.error(\"AuthManager component not found on SignupLogin prefab!\");\r\n            return;\r\n        }\r\n\r\n        this.initSignupLogin();\r\n        });\r\n    }\r\n\r\n    initSignupLogin() {\r\n        // “Exit” button wiring (unchanged)…\r\n        let ExitSignupLoginButton = new cc.Component.EventHandler();\r\n        ExitSignupLoginButton.target = this.node;\r\n        ExitSignupLoginButton.component = \"MenuMgr\";\r\n        ExitSignupLoginButton.handler = \"ExitSignupLogin\";\r\n        cc.find(\"Canvas/Setting/SignupLogin/Exit\").getComponent(cc.Button).clickEvents.push(ExitSignupLoginButton);\r\n\r\n        // “Save” button now calls either authComp.SignUp or authComp.Login\r\n        let SaveSignupLoginButton = new cc.Component.EventHandler();\r\n        SaveSignupLoginButton.target = this.authComp!.node;\r\n        SaveSignupLoginButton.component = \"AuthManager\";\r\n        SaveSignupLoginButton.handler = this.isSigningUp ? \"SignUp\" : \"Login\";\r\n        cc.find(\"Canvas/Setting/SignupLogin/Save\").getComponent(cc.Button).clickEvents.push(SaveSignupLoginButton);\r\n    }\r\n\r\n    ExitSignupLogin() {\r\n        let T_Node = cc.find(\"Canvas/Setting/SignupLogin\");\r\n        if(T_Node) {\r\n            T_Node.destroy();\r\n        }\r\n    }\r\n\r\n    public enableStartButton() {\r\n        if (this.startGameButton) {\r\n            this.startGameButton.node.active = true;\r\n        }\r\n    }\r\n}"]}