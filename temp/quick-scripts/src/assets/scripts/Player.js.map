{"version":3,"sources":["assets/scripts/Player.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst { ccclass, property } = cc._decorator;\nimport GameManager from \"./GameManager\";\n\n@ccclass\nexport default class Player extends cc.Component {\n    @property({type: cc.Integer, tooltip: \"最大血量\"})\n    maxHp: number = 40;\n\n    @property({type: cc.Integer, tooltip: \"攻擊力\"})\n    attackPower: number = 5;\n\n    @property({type: cc.Integer, tooltip: \"初始血量\"})\n    hp: number = 40;\n\n    @property(cc.Node)\n    private lifebar: cc.Node = null;\n\n    @property(cc.Node)\n    controller: cc.Node = null;\n\n    @property(cc.AudioClip)\n    attack1sound: cc.AudioClip = null;\n\n    @property(cc.AudioClip)\n    attack2sound: cc.AudioClip = null;\n\n    @property(cc.AudioClip)\n    attack3sound: cc.AudioClip = null;\n\n    @property(cc.AudioClip)\n    hurtsound: cc.AudioClip = null;\n\n    @property(cc.AudioClip)\n    healsound: cc.AudioClip = null;\n\n    onLoad(){\n\n    }\n\n    public SetPlayer(level: number){\n        //reset player position\n        this.hp = this.maxHp;\n        this.updatelife(0, this.hp);\n        this.node.setPosition(20,20);\n\n    }\n\n    updatelife(num: number, hp: number){\n        console.log(num, hp);\n        this.lifebar.width = hp;\n        if(hp<=10) this.lifebar.color = cc.Color.RED;\n        else if(hp<=20) this.lifebar.color = cc.Color.ORANGE;\n        else this.lifebar.color = cc.Color.GREEN;\n    }\n\n    public playattack1sound(){\n        if(this.attack1sound) cc.audioEngine.playEffect(this.attack1sound,false);\n        else console.log(\"No attack1 sound\");\n    }\n\n    public playhealsound(){\n        if(this.healsound) cc.audioEngine.playEffect(this.healsound,false);\n    }\n\n    public playhurtsound(){\n        if(this.hurtsound) cc.audioEngine.playEffect(this.hurtsound,false);\n    }\n\n    public playattack2sound(){\n        if(this.attack2sound) cc.audioEngine.playEffect(this.attack2sound,false);\n    }\n\n    public playattack3sound(){\n        if(this.attack3sound) cc.audioEngine.playEffect(this.attack3sound,false);\n    }\n\n    public get worldPosition(): cc.Vec3 {\n        return this.node.convertToWorldSpaceAR(cc.v3(0, 0, 0));\n    }\n\n    public get localPosition(): cc.Vec3 {\n        return this.node.position;\n    }\n\n    public takeDamage(amount: number) {\n        this.hp -= amount; \n        this.updatelife(-amount, this.hp);\n        if(this.hp <= 0){\n            this.die();\n        }\n    }\n\n    public heal(amount: number) {\n        \n        this.hp += amount;\n        if (this.hp > this.maxHp) this.hp = this.maxHp;\n        this.updatelife(amount, this.hp);\n        this.playhealsound();\n    }\n\n    public attack(target: Player) {\n        target.takeDamage(this.attackPower);\n    }\n    public die() {\n        if(this.hp <= 0){\n            this.updatelife(-this.maxHp, 0);\n            this.controller.getComponent(\"ActorController\").godie();\n        } \n        // Call GameManager to handle game over logic\n    }\n\n}"]}