{"version":3,"sources":["assets/scripts/MapManager.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,kFAAkF;AAClF,yFAAyF;AACzF,mBAAmB;AACnB,4FAA4F;AAC5F,mGAAmG;AACnG,8BAA8B;AAC9B,4FAA4F;AAC5F,mGAAmG;;;;;;;;;;;;;;;;;;;;;AAEnG,uDAAkD;AAE5C,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAwC,8BAAY;IAApD;QAAA,qEAoCC;QA7BG,qBAAe,GAAY,IAAI,CAAC;QAEhC,oBAAc,GAAY,IAAI,CAAC;;QA0B/B,iBAAiB;IACrB,CAAC;mBApCoB,UAAU;IAG3B,sBAAkB,sBAAQ;aAA1B;YACI,OAAO,YAAU,CAAC,QAAQ,CAAC;QAC/B,CAAC;;;OAAA;IAOD,wBAAwB;IAExB,2BAAM,GAAN;QACI,EAAE,CAAC,QAAQ,CAAC,iBAAiB,EAAE,CAAC,OAAO,GAAG,IAAI,CAAC;QAC/C,YAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;QAC3B,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,qBAAW,CAAC,CAAC;IACnD,CAAC;IAED,0BAAK,GAAL;QACI,IAAI,MAAM,GAAc,EAAE,CAAC;QAC3B,KAAkB,UAA4B,EAA5B,KAAA,IAAI,CAAC,cAAc,CAAC,QAAQ,EAA5B,cAA4B,EAA5B,IAA4B,EAAE;YAA3C,IAAI,KAAK,SAAA;YACV,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACtB;QACD,KAAkB,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAM,EAAE;YAArB,IAAI,KAAK,eAAA;YACV,gFAAgF;YAChF,wDAAwD;YACxD,aAAa;YACb,IAAI,cAAc,GAAG,KAAK,CAAC,qBAAqB,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC/D,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YACtC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,CAAC,oBAAoB,CAAC,cAAc,CAAC,CAAC,CAAC;SACxE;IACL,CAAC;;IA/Bc,mBAAQ,GAAe,IAAI,CAAC;IAK3C;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;uDACc;IAEhC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;sDACa;IATd,UAAU;QAD9B,OAAO;OACa,UAAU,CAoC9B;IAAD,iBAAC;CApCD,AAoCC,CApCuC,EAAE,CAAC,SAAS,GAoCnD;kBApCoB,UAAU","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport ZSortOnLoad from \"./utilities/ZSortOnLoad\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class MapManager extends cc.Component {\n\n    private static instance: MapManager = null;\n    public static get Instance() {\n        return MapManager.instance;\n    }\n    @property(cc.Node)\n    objectLayerNode: cc.Node = null;\n    @property(cc.Node)\n    actorLayerNode: cc.Node = null;\n        \n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        cc.director.getPhysicsManager().enabled = true;\n        MapManager.instance = this;\n        this.objectLayerNode.addComponent(ZSortOnLoad);\n    }\n\n    start() {\n        let actors: cc.Node[] = [];\n        for (let actor of this.actorLayerNode.children) {\n            actors.push(actor);\n        }\n        for (let actor of actors) {\n            // Possibly an engine bug: A node's world position can change after reparenting.\n            // That's why we have to fix the position manually here.\n            // Bad API :(\n            let worldPosBefore = actor.convertToWorldSpaceAR(cc.Vec2.ZERO);\n            actor.setParent(this.objectLayerNode);\n            actor.setPosition(actor.parent.convertToNodeSpaceAR(worldPosBefore));\n        }\n    }\n\n    // update (dt) {}\n}\n"]}