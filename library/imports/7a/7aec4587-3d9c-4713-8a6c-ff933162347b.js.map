{"version":3,"sources":["assets/scripts/Menu/LoadingManager.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAE5E,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAA4C,kCAAY;IAAxD;QAAA,qEAiCC;QA/BG,iBAAW,GAAmB,IAAI,CAAC;QAGnC,kBAAY,GAAa,IAAI,CAAC;;IA4BlC,CAAC;IA1BG,qCAAY,GAAZ,UAAa,WAAmB;QAAhC,iBAuBC;QAtBD,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,CAAC,CAAC;QAC9B,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,IAAI,CAAC;QAEhC,EAAE,CAAC,QAAQ,CAAC,YAAY,CACpB,WAAW,EACX,UAAC,cAAc,EAAE,UAAU,EAAE,IAAI;YAC7B,IAAI,QAAQ,GAAG,cAAc,GAAG,UAAU,CAAC;YAC3C,mBAAmB;YACnB,IAAI,QAAQ,GAAG,GAAG;gBAAE,QAAQ,GAAG,GAAG,CAAC;YACnC,KAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACrC,KAAI,CAAC,YAAY,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;QAChE,CAAC,EACD;YACI,wBAAwB;YACxB,EAAE,CAAC,KAAK,CAAC,KAAI,CAAC,WAAW,CAAC;iBACrB,EAAE,CAAC,GAAG,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;iBACxB,IAAI,CAAC;gBACF,KAAI,CAAC,YAAY,CAAC,MAAM,GAAG,MAAM,CAAC;gBAClC,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;YACvC,CAAC,CAAC;iBACD,KAAK,EAAE,CAAC;QACjB,CAAC,CAAC,CAAC;IACP,CAAC;IA5BD;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;uDACU;IAGnC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;wDACW;IALb,cAAc;QADlC,OAAO;OACa,cAAc,CAiClC;IAAD,qBAAC;CAjCD,AAiCC,CAjC2C,EAAE,CAAC,SAAS,GAiCvD;kBAjCoB,cAAc","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class LoadingManager extends cc.Component {\n    @property(cc.ProgressBar)\n    progressBar: cc.ProgressBar = null;\n\n    @property(cc.Label)\n    percentLabel: cc.Label = null;\n\n    startLoading(targetScene: string) {\n    this.progressBar.progress = 0;\n    this.percentLabel.string = \"0%\";\n\n    cc.director.preloadScene(\n        targetScene,\n        (completedCount, totalCount, item) => {\n            let progress = completedCount / totalCount;\n            // 預設最多到 0.9，預留補滿動畫\n            if (progress > 0.9) progress = 0.9;\n            this.progressBar.progress = progress;\n            this.percentLabel.string = Math.floor(progress * 100) + \"%\";\n        },\n        () => {\n            // 預加載完成時，tween 補滿到 100%\n            cc.tween(this.progressBar)\n                .to(0.3, { progress: 1 })\n                .call(() => {\n                    this.percentLabel.string = \"100%\";\n                    cc.director.loadScene(targetScene);\n                })\n                .start();\n        });\n    }\n\n\n}\n\n"]}